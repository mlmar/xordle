var B=Object.defineProperty,M=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var U=(t,s,n)=>s in t?B(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,E=(t,s)=>{for(var n in s||(s={}))W.call(s,n)&&U(t,n,s[n]);if(G)for(var n of G(s))Y.call(s,n)&&U(t,n,s[n]);return t},C=(t,s)=>M(t,J(s));import{j as K,r as m,R as F,a as V}from"./vendor.2d6b8063.js";const H=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))e(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&e(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}};H();const l=K.exports.jsx,p=K.exports.jsxs,_=K.exports.Fragment,w={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},z={MENU_OPTIONS:[{id:w.CREATE,text:"CREATE"},{id:w.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:l(_,{children:"\xA0"})},b=E(E({},w),z),$="xordle.herokuapp.com",X="wss://"+$;let i=null,I=null,S=null;const P={},T=(t,s)=>t.split(" ").forEach(n=>P[n]=s),j=t=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(S),S=null);const s=()=>{i.emit("PING")};return T("PING",()=>{console.log("Received server ping")}),T("RECONNECT",n=>{n||t()}),T("SET_ID",n=>{!i||(i.id=n,I&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:I})),I=n,console.log("Socket initialized"))}),i=new WebSocket(X),i.emit=(n,e)=>{i?i.send(JSON.stringify({action:n,payload:e})):console.warn("No client found")},i.addEventListener("message",n=>{const{data:e}=n,{action:r,payload:o}=JSON.parse(e);P[r]&&P[r](o)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),j()}),S=setInterval(s,b.PING_DELAY),i},k={init:j,listen:T},q=t=>{const{children:s,onDisconnect:n}=t;return m.exports.useEffect(()=>{k.init(n)},[]),l(_,{children:s})},Z=t=>{const{options:s,onClick:n,className:e}=t,r=()=>e?" "+e:"",o=c=>{const{id:u}=c.target;n&&u&&n(u)};return l("div",{className:"menu flex-col"+r(),onClick:o,children:s.map(({id:c,text:u})=>p("button",{id:c,children:[" ",u," "]},c))})};const L=t=>{switch(parseInt(t)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},Q=t=>t<33?"bg-red":t<66?"bg-yellow":"bg-green",D=t=>/^[a-zA-Z]$/.test(t);const ee=t=>{const{keys:s,onClick:n,disabled:e}=t,r=c=>{var u;e||(c.preventDefault(),c.target.id?n&&n({key:c.target.id}):(u=c.touches)==null||u.forEach(g=>{n&&n({key:g.id})}))},o=(c,u,g)=>{const a=b.KEYS["ROW_"+c];return p("div",{className:"flex keyboard-row",children:[u,a.map(h=>l(O,{letter:h,status:(s==null?void 0:s[h])>=0?s[h]:3,id:h},h)),g]})};return p("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:r,onClick:r,children:[o(0),o(1),o(2,l(O,{letter:"ENTER",status:3,id:"enter"}),l(O,{letter:l(_,{children:"\xAB"}),status:3,id:"backspace"}))]})},O=({letter:t,status:s,className:n,id:e})=>{let r=["flex keyboard-key",L(s),n||""].join(" ");return p("button",{className:r,id:e,children:[" ",t," "]})},ne=t=>{const{keys:s,history:n,inProgress:e,timeRemaining:r,keyboardDisabled:o,onKeyPress:c,current:u,room:g}=t,a=m.exports.useRef(null),h=m.exports.useRef(null);m.exports.useEffect(()=>{var f;(f=a==null?void 0:a.current)==null||f.focus()},[a]),m.exports.useEffect(()=>{h.current.scrollIntoView()},[u]);const d=f=>{if(!o)switch(f.key.toUpperCase()){case"ENTER":c&&c("ENTER");break;case"BACKSPACE":c&&c(null);break;default:D(f.key)&&c&&c(f.key.toUpperCase());break}},x=()=>n==null?void 0:n.map((f,N)=>n.length-1===N?l("div",{className:"flex game-board-last",children:f==null?void 0:f.map((R,v)=>m.exports.createElement(A,C(E({},R),{key:R+v,delay:v*60})))},f+N):l("div",{className:"flex",children:f==null?void 0:f.map((R,v)=>m.exports.createElement(A,C(E({},R),{key:R+v})))},f+N)),y=()=>{const f=[];for(let N=0;N<5;N++)f.push(l(A,{letter:u[N],status:u[N]?4:5},(u[N]||"")+N));return f};return p("div",{className:"game-board flex-col flex-fill ",onKeyDown:d,tabIndex:"0",ref:a,children:[p("label",{className:"floating-purple-text float-right",children:[" ",g," "]}),p("div",{className:"flex-col flex-fill overflow game-board-list",children:[x(),l("div",{className:"flex game-board-current",ref:h,children:e&&y()},n==null?void 0:n.length)]}),l(se,{className:"game-board-progress",progress:r}),l(ee,{keys:s,disabled:o,onClick:d})]})},se=({className:t,progress:s})=>{const n=s*100,e=[t||"","flex progress"].join(" "),r=["flex progress-bar",Q(n)].join(" "),o={width:n+"%"};return l("div",{className:e,children:l("div",{className:r,style:o})})},A=({letter:t,status:s,delay:n})=>{const[e,r]=m.exports.useState("bg-placeholder");m.exports.useEffect(()=>{n&&setTimeout(()=>{r(L(s))},n)},[s,n]);const o=["flex game-board-letter",n?e:L(s)].join(" ");return l("div",{className:"game-board-letter-wrapper",children:p("span",{className:o,children:[" ",t||b.BLANK," "]})})},te=t=>{const{room:s,children:n}=t,[e,r]=m.exports.useState(null),[o,c]=m.exports.useState([]),u=()=>(e==null?void 0:e.host)===i.id;m.exports.useEffect(()=>{i.room=s,i.emit("JOIN",{room:s}),k.listen("JOIN",r),k.listen("UPDATE",d=>{r(()=>((d==null?void 0:d.status)===1?c([]):(d==null?void 0:d.status)===0&&(d==null?void 0:d.turn)!==i.id&&c(d==null?void 0:d.current),d))})},[]);const g=()=>{u()&&i.emit("START")},a=()=>{u()&&i.emit("END")},h=d=>{d==="ENTER"?o.length===5?i.emit("ENTER_WORD"):c([]):c(d?x=>{const y=x.length<5?[...x,d]:x;return i.emit("SET_CURRENT",{current:y}),y}:x=>{if(x.length===0)return[];const y=[...x];return y.pop(),i.emit("SET_CURRENT",{current:y}),y})};return p("div",{className:"flex-col flex-fill game",children:[!(e!=null&&e.inProgress)&&n,(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&p("div",{className:"flex-col flex-fill game-end",children:[l("label",{className:"game-end-label",children:" Word: "}),p("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),l("button",{className:u()?"":"hidden",onClick:a,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&l(ne,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:o,onKeyPress:h,inProgress:e==null?void 0:e.turn,timeRemaining:e==null?void 0:e.timeRemaining,keyboardDisabled:(e==null?void 0:e.turn)!==(i==null?void 0:i.id),room:s}),!(e!=null&&e.inProgress)&&p("div",{className:"flex-col flex-fill game-lobby",children:[p("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),p("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),l("button",{className:"start-btn",onClick:g,children:u()?"START":"WAITING FOR HOST"})]})]})},re=()=>{const[t,s]=m.exports.useReducer(le,oe),n=m.exports.useRef(!1);m.exports.useEffect(()=>{k.listen("CREATE",a=>{s({type:"viewJoin",payload:{room:a}}),n.current=!1}),k.listen("VERIFY",a=>{n.current=!1,a&&s({type:"viewJoin",payload:{room:a}})})},[]);const e=a=>{if(!n.current)switch(a){case b.CREATE:n.current=!0,i.emit("CREATE");break;case b.JOIN:s({type:"viewCodeInput"});break;case b.PLAY:n.current=!0,i.emit("VERIFY",{room:t.room});break;default:console.log(a);return}},r=()=>{s({type:"viewMain"})},o=a=>{s({type:"setCodeInput",payload:a.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},c=()=>{var a;return p("div",{className:"flex-col",children:[l("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:t.room||"",onChange:o,spellCheck:"false",autoComplete:"false",autoFocus:!0}),l("button",{className:"flex play-btn "+(((a=t.room)==null?void 0:a.length)===5?"":"hidden"),onClick:()=>e(b.PLAY),children:l("img",{src:b.TRIANGLE_RIGHT})})]})};return l("div",{className:"app",children:l(q,{onDisconnect:()=>{s({type:"viewMain"})},children:(()=>{const a=t.view&&l("button",{className:"back-btn",onClick:r,children:" BACK "});switch(t.view){case"game":return l(te,{room:t.room,children:a});case"codeInput":return p("div",{className:"main-screen flex-col flex-fill",children:[a,l("label",{className:"flex title-label",children:" XORDLE "}),c()]});default:return p("div",{className:"main-screen flex-col flex-fill",children:[a,l("label",{className:"flex title-label",children:" XORDLE "}),l(Z,{options:b.MENU_OPTIONS,onClick:e})]})}})()})})},le=(t,s)=>{const{type:n,payload:e}=s;switch(n){case"viewMain":return C(E({},t),{view:null,room:null});case"viewJoin":return C(E({},t),{view:"game",room:e.room});case"viewCodeInput":return C(E({},t),{view:"codeInput"});case"setCodeInput":return C(E({},t),{room:e});default:return E({},t)}},oe={view:b.VIEW,room:null};F.render(l(V.StrictMode,{children:l(re,{})}),document.getElementById("root"));
