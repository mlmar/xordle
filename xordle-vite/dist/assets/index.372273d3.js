var P=Object.defineProperty,K=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var v=(t,r,s)=>r in t?P(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,y=(t,r)=>{for(var s in r||(r={}))U.call(r,s)&&v(t,s,r[s]);if(g)for(var s of g(r))G.call(r,s)&&v(t,s,r[s]);return t},x=(t,r)=>K(t,_(r));import{j as k,r as p,R as J,a as W}from"./vendor.2d6b8063.js";const j=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}};j();const c=k.exports.jsx,u=k.exports.jsxs,S=k.exports.Fragment,C={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},M={MENU_OPTIONS:[{id:C.CREATE,text:"CREATE"},{id:C.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",BLANK:c(S,{children:"\xA0"})},E=y(y({},C),M),V="wss://xordle.onrender.com";let d=null;const T={},A=(t,r)=>T[t]=r,Y=()=>{if(d){console.warn("Socket already iniitialized");return}return A("SET_ID",t=>{d&&(d.id=t)}),d=new WebSocket(V),d.emit=(t,r)=>{d.send(JSON.stringify({action:t,payload:r}))},d.addEventListener("message",t=>{const{data:r}=t,{action:s,payload:e}=JSON.parse(r);T[s]&&T[s](e)}),console.log("Socket Initialized"),d},b={init:Y,listen:A},B=({children:t})=>(p.exports.useEffect(()=>{b.init()},[]),c(S,{children:t})),F=t=>{const{options:r,onClick:s,className:e}=t,n=()=>e?" "+e:"",o=i=>{const{id:l}=i.target;s&&l&&s(l)};return c("div",{className:"menu flex-col"+n(),onClick:o,children:r.map(({id:i,text:l})=>u("button",{id:i,children:[" ",l," "]},i))})};const w=t=>{switch(parseInt(t)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder";default:return"bg-gray"}},z=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16));const $=t=>{const{keys:r,onClick:s,disabled:e}=t,n=i=>{var m,h;if(e)return;i.preventDefault();const l=((h=(m=i.touches)==null?void 0:m[0])==null?void 0:h.target.id)||i.target.id;s&&s({key:l})},o=(i,l,m)=>{const h=E.KEYS["ROW_"+i];return u("div",{className:"flex keyboard-row",children:[l,h.map(f=>c(R,{letter:f,status:(r==null?void 0:r[f])>=0?r[f]:3,id:f},f)),m]})};return u("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:n,onClick:n,children:[o(0),o(1),o(2,c(R,{letter:"ENTER",status:3,id:"enter"}),c(R,{letter:c(S,{children:"\xAB"}),status:3,id:"backspace"}))]})},R=({letter:t,status:r,className:s,id:e})=>{let n=["flex keyboard-key",w(r),s||""].join(" ");return u("button",{className:n,id:e,children:[" ",t," "]})},H=t=>{const{keys:r,history:s,inProgress:e,keyboardDisabled:n,onKeyPress:o,current:i}=t,l=p.exports.useRef(null),m=p.exports.useRef(null);p.exports.useEffect(()=>{var a;(a=l==null?void 0:l.current)==null||a.focus()},[l]),p.exports.useEffect(()=>{m.current.scrollIntoView()},[i]);const h=a=>{if(!n)switch(a.key.toUpperCase()){case"ENTER":o&&o("ENTER");break;case"BACKSPACE":o&&o(null);break;default:/^[a-zA-Z]$/.test(a.key)&&o&&o(a.key);break}},f=()=>{const a=[];for(let N=0;N<5;N++)a.push(c(O,{letter:i[N]||E.BLANK,status:4},z()));return a};return u("div",{className:"game-board flex-col flex-fill ",onKeyDown:h,tabIndex:"0",ref:l,children:[u("div",{className:"flex-col flex-fill overflow game-board-list",children:[s==null?void 0:s.map((a,N)=>c("div",{className:"flex",children:a==null?void 0:a.map((I,L)=>p.exports.createElement(O,x(y({},I),{key:I+L})))},a+N)),c("div",{className:"flex",ref:m,children:e&&f()})]}),c($,{keys:r,disabled:n,onClick:h})]})},O=({letter:t,status:r})=>{const s=["flex game-board-letter",w(r)].join(" ");return c("div",{className:"game-board-letter-wrapper",children:u("span",{className:s,children:[" ",t," "]})})},X=t=>{const{host:r,room:s}=t,[e,n]=p.exports.useState(null),[o,i]=p.exports.useState([]);p.exports.useEffect(()=>{d.emit("JOIN",{room:s}),b.listen("JOIN",n),b.listen("UPDATE",f=>{n(f)})},[]),p.exports.useEffect(()=>{o!==(e==null?void 0:e.current)&&i(e==null?void 0:e.current)},[o,e]);const l=()=>{r&&d.emit("START")},m=()=>{r&&d.emit("END")},h=f=>{f==="ENTER"?(i([]),d.emit("ENTER_WORD")):f?(i(a=>a.length<5?[...a,f]:a),d.emit("PRESS_LETTER",{letter:f})):(i(a=>{let N=[...a];return N.pop(),N}),d.emit("REMOVE_LETTER"))};return u("div",{className:"flex-col flex-fill game",children:[(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&u("div",{className:"flex-col flex-fill game-end",children:[c("label",{className:"game-end-label",children:" Word: "}),u("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word,"  "]}),c("button",{className:r?"":"hidden",onClick:m,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&c(H,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:o,onKeyPress:h,inProgress:e==null?void 0:e.turn,keyboardDisabled:(e==null?void 0:e.turn)!==(d==null?void 0:d.id)}),!(e!=null&&e.inProgress)&&u("div",{className:"flex-col flex-fill game-lobby",children:[u("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),u("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),c("button",{className:"start-btn",onClick:l,children:r?"START":"WAITING FOR HOST"})]})]})},q=()=>{const[t,r]=p.exports.useReducer(Z,Q),s=p.exports.useRef(!1);p.exports.useEffect(()=>{b.listen("CREATE",l=>{r({type:"viewJoin",payload:{room:l,host:!0}}),s.current=!1}),b.listen("VERIFY",l=>{s.current=!1,l&&r({type:"viewJoin",payload:{room:l,host:!1}})})},[]),p.exports.useEffect(()=>{setInterval(()=>{d.emit("PING_TEST")},6e4)},[]);const e=l=>{if(!s.current)switch(l){case E.CREATE:s.current=!0,d.emit("CREATE");break;case E.JOIN:r({type:"viewCodeInput"});break;case E.PLAY:s.current=!0,d.emit("VERIFY",{room:t.room});break;default:console.log(l);return}},n=l=>{r({type:"setCodeInput",payload:l.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},o=()=>{var l;return u("div",{className:"flex-col",children:[c("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:t.room||"",onChange:n,spellCheck:"false",autoComplete:"false",autoFocus:!0}),c("button",{className:"flex play-btn "+(((l=t.room)==null?void 0:l.length)===5?"":"hidden"),onClick:()=>e(E.PLAY),children:c("img",{src:E.TRIANGLE_RIGHT})})]})};return c("div",{className:"app",children:c(B,{children:(()=>{switch(t.view){case"game":return c(X,{host:t.host,room:t.room});default:return u("div",{className:"main-screen flex-col flex-fill",children:[c("label",{className:"flex title-label",children:" XORDLE "}),t.view!=="codeInput"?c(F,{options:E.MENU_OPTIONS,onClick:e}):o()]})}})()})})},Z=(t,r)=>{const{type:s,payload:e}=r;switch(s){case"viewJoin":return x(y({},t),{view:"game",room:e.room,host:e.host});case"viewCodeInput":return x(y({},t),{view:"codeInput"});case"setCodeInput":return x(y({},t),{room:e});default:return y({},t)}},Q={view:E.VIEW,room:null};J.render(c(W.StrictMode,{children:c(q,{})}),document.getElementById("root"));
