var j=Object.defineProperty,B=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var G=(n,e,s)=>e in n?j(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,h=(n,e)=>{for(var s in e||(e={}))W.call(e,s)&&G(n,s,e[s]);if(_)for(var s of _(e))F.call(e,s)&&G(n,s,e[s]);return n},R=(n,e)=>B(n,J(e));import{j as M,r as p,R as V,a as z}from"./vendor.8cd058a3.js";const H=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))t(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&t(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(l){if(l.ep)return;l.ep=!0;const r=s(l);fetch(l.href,r)}};H();const o=M.exports.jsx,f=M.exports.jsxs,U=M.exports.Fragment,w={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},$={MENU_OPTIONS:[{id:w.CREATE,text:"CREATE"},{id:w.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:o(U,{children:"\xA0"})},x=h(h({},w),$),X="xordle.herokuapp.com",q="wss://"+X;let i=null,T=null,A=null;const P={},L=(n,e)=>n.split(" ").forEach(s=>P[s]=e),Y=()=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(A),A=null);const n=()=>{i.emit("PING")};return L("PING",()=>{console.log("Received server ping")}),L("SET_ID",e=>{!i||(i.id=e,T&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:T})),T=e,console.log("Socket initialized"))}),i=new WebSocket(q),i.emit=(e,s)=>{i?i.send(JSON.stringify({action:e,payload:s})):console.warn("No client found")},i.addEventListener("message",e=>{const{data:s}=e,{action:t,payload:l}=JSON.parse(s);P[t]&&P[t](l)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),Y()}),A=setInterval(n,x.PING_DELAY),i},v={init:Y,listen:L},Z=n=>{const{children:e}=n;return p.exports.useEffect(()=>{v.init()},[]),o(U,{children:e})},Q=n=>{const{options:e,onClick:s,className:t}=n,l=()=>t?" "+t:"",r=d=>{const{id:a}=d.target;s&&a&&s(a)};return o("div",{className:"menu flex-col"+l(),onClick:r,children:e.map(({id:d,text:a})=>f("button",{id:d,children:[" ",a," "]},d))})};const K=n=>{switch(parseInt(n)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},D=n=>n<33?"bg-red":n<66?"bg-yellow":"bg-green",ee=n=>/^[a-zA-Z]$/.test(n);const te=n=>{const{keys:e,onClick:s,disabled:t}=n,l=a=>{t||a.target.id&&s&&s({key:a.target.id})},r=(a,g,b)=>{const c=x.KEYS["ROW_"+a];return f("div",{className:"flex keyboard-row",children:[g,c.map(m=>o(O,{letter:m,status:(e==null?void 0:e[m])>=0?e[m]:3,id:m},m)),b]})},d=a=>a.preventDefault();return f("div",{className:"keyboard flex-col "+(t?"disabled":""),onTouchEnd:d,onTouchStart:l,onMouseUp:l,children:[r(0),r(1),r(2,o(O,{letter:"ENTER",status:3,id:"enter"}),o(O,{letter:o(U,{children:"\xAB"}),status:3,id:"backspace"}))]})},O=({letter:n,status:e,className:s,id:t})=>{let l=["flex keyboard-key",K(e),s||""].join(" ");return o("span",{className:"flex keyboard-key-container",children:f("button",{className:l,id:t,children:[" ",n," "]})})},ne=n=>{const{keys:e,history:s,inProgress:t,timeRemaining:l,keyboardDisabled:r,onKeyPress:d,current:a,room:g,name:b}=n,c=p.exports.useRef(null),m=p.exports.useRef(null);p.exports.useEffect(()=>{var u;(u=c==null?void 0:c.current)==null||u.focus()},[c]),p.exports.useEffect(()=>{m.current.scrollIntoView()},[a]);const k=u=>{if(!r)switch(u.key.toUpperCase()){case"ENTER":d&&d("ENTER");break;case"BACKSPACE":d&&d(null);break;default:ee(u.key)&&d&&d(u.key.toUpperCase());break}},C=()=>s==null?void 0:s.map((u,E)=>s.length-1===E?o("div",{className:"flex game-board-last",children:u==null?void 0:u.map((y,I)=>p.exports.createElement(S,R(h({},y),{key:y+I,delay:I*60})))},u+E):o("div",{className:"flex",children:u==null?void 0:u.map((y,I)=>p.exports.createElement(S,R(h({},y),{key:y+I})))},u+E)),N=()=>{const u=[];for(let E=0;E<5;E++)u.push(o(S,{letter:a[E],status:a[E]?4:5},(a[E]||"")+E));return u};return f("div",{className:"game-board flex-col flex-fill ",onKeyDown:k,tabIndex:"0",ref:c,children:[f("label",{className:"floating-purple-text float-left",children:[" ",b," "]}),f("label",{className:"floating-purple-text float-right",children:[" ",g," "]}),f("div",{className:"flex-col flex-fill overflow game-board-list",children:[C(),o("div",{className:"flex game-board-current",ref:m,children:t&&N()},s==null?void 0:s.length)]}),o(se,{className:"game-board-progress",progress:l}),o(te,{keys:e,disabled:r,onClick:k})]})},se=({className:n,progress:e})=>{const s=e*100,t=[n||"","flex progress"].join(" "),l=["flex progress-bar",D(s)].join(" "),r={width:s+"%"};return o("div",{className:t,children:o("div",{className:l,style:r})})},S=({letter:n,status:e,delay:s})=>{const[t,l]=p.exports.useState("bg-placeholder active");p.exports.useEffect(()=>{s&&setTimeout(()=>{l(K(e))},s)},[e,s]);const r=["flex game-board-letter",s?t:K(e)].join(" ");return o("div",{className:"game-board-letter-wrapper",children:f("span",{className:r,children:[" ",n||x.BLANK," "]})})},re=n=>{const{room:e,children:s}=n,[t,l]=p.exports.useState(null),[r,d]=p.exports.useState(null),[a,g]=p.exports.useState([]),b=()=>(t==null?void 0:t.host)===i.id;p.exports.useEffect(()=>{i.room=e,i.emit("JOIN",{room:e}),v.listen("JOIN",l),v.listen("UPDATE",l),v.listen("PLAYER_UPDATE",d)},[]),p.exports.useEffect(()=>{((r==null?void 0:r.correct)===!1||(r==null?void 0:r.correct)===!0)&&g([])},[r]);const c=()=>{b()&&i.emit("START")},m=()=>{b()&&i.emit("END")},k=C=>{C==="ENTER"?(a.length===5&&i.emit("ENTER_WORD",{current:a}),g([])):g(C?N=>N.length<5?[...N,C]:N:N=>{if(N.length===0)return[];const u=[...N];return u.pop(),u})};return f("div",{className:"flex-col flex-fill game",children:[!(t!=null&&t.status)>0&&s,(t==null?void 0:t.status)===2&&f("div",{className:"flex-col flex-fill game-end",children:[f("label",{className:"game-end-word",children:[" WORD: ",t==null?void 0:t.word," "]}),t==null?void 0:t.winOrder.map((C,N)=>N<4?f("label",{className:"game-end-word",children:[" ",N+1,". ",C," "]},N+C):null),o("button",{className:b()?"":"hidden",onClick:m,children:" RESTART "})]}),(t==null?void 0:t.status)>0&&o(ne,{keys:r==null?void 0:r.keys,history:r==null?void 0:r.history,current:a,onKeyPress:k,inProgress:r==null?void 0:r.inProgress,timeRemaining:r==null?void 0:r.timeRemaining,keyboardDisabled:!(r!=null&&r.inProgress),name:(r==null?void 0:r.name)||i.name,room:e}),(t==null?void 0:t.status)===0&&f("div",{className:"flex-col flex-fill game-lobby",children:[f("label",{className:"flex room-code",children:[" ",t==null?void 0:t.id," "]}),f("p",{className:"flex-col flex-fill",children:[" ",t==null?void 0:t.playerCount," PLAYER",(t==null?void 0:t.playerCount)>1?"S":""," "]}),o("button",{className:"start-btn",onClick:c,children:b()?"START":"WAITING FOR HOST"})]})]})},le=()=>{const[n,e]=p.exports.useReducer(oe,ce),s=p.exports.useRef(!1);p.exports.useEffect(()=>{v.listen("CREATE",c=>{e({type:"viewJoin",payload:{room:c}}),s.current=!1}),v.listen("VERIFY",c=>{s.current=!1,c&&e({type:"viewJoin",payload:{room:c}})}),v.listen("RECONNECT",c=>{c||e({type:"viewMain"})})},[]);const t=c=>{if(!s.current)switch(c){case x.CREATE:s.current=!0,i.emit("CREATE");break;case x.JOIN:e({type:"viewCodeInput"});break;case x.PLAY:s.current=!0,i.emit("VERIFY",{room:n.room});break;default:console.log(c);return}},l=()=>{i.emit("LEAVE"),e({type:"viewMain"})},r=c=>{e({type:"setCodeInput",payload:c.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},d=()=>{var c;return f("div",{className:"flex-col",children:[o("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:n.room||"",onChange:r,spellCheck:"false",autoComplete:"false",autoFocus:!0}),o("button",{className:"flex play-btn "+(((c=n.room)==null?void 0:c.length)===5?"":"hidden"),onClick:()=>t(x.PLAY),children:o("img",{src:x.TRIANGLE_RIGHT})})]})},a=c=>{const m=c.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase();e({type:"setNameInput",payload:m}),i.name=m,i.emit("NAME",{name:m})},g=()=>o("div",{className:"flex-col",children:o("input",{className:"input",type:"text",placeholder:"PLAYER NAME",value:n.name||"",onChange:a,spellCheck:"false",autoComplete:"false",autoFocus:!0})});return o("div",{className:"app",children:o(Z,{children:(()=>{const c=n.view&&o("button",{className:"back-btn",onClick:l,children:" BACK "});switch(n.view){case"game":return o(re,{room:n.room,children:c});case"codeInput":return f("div",{className:"main-screen flex-col flex-fill",children:[c,o("label",{className:"flex title-label",children:" XORDLE "}),d()]});default:return f("div",{className:"main-screen flex-col flex-fill",children:[c,o("label",{className:"flex title-label",children:" XORDLE "}),g(),o(Q,{options:x.MENU_OPTIONS,onClick:t})]})}})()})})},oe=(n,e)=>{const{type:s,payload:t}=e;switch(s){case"viewMain":return R(h({},n),{view:null,room:null});case"viewJoin":return R(h({},n),{view:"game",room:t.room});case"viewCodeInput":return R(h({},n),{view:"codeInput"});case"setCodeInput":return R(h({},n),{room:t});case"setNameInput":return R(h({},n),{name:t});default:return h({},n)}},ce={view:x.VIEW,room:null};V.render(o(z.StrictMode,{children:o(le,{})}),document.getElementById("root"));
