var B=Object.defineProperty,Y=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var U=(r,n,s)=>n in r?B(r,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[n]=s,E=(r,n)=>{for(var s in n||(n={}))M.call(n,s)&&U(r,s,n[s]);if(G)for(var s of G(n))W.call(n,s)&&U(r,s,n[s]);return r},R=(r,n)=>Y(r,J(n));import{j as K,r as m,R as F,a as V}from"./vendor.2d6b8063.js";const H=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerpolicy&&(c.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?c.credentials="include":t.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function e(t){if(t.ep)return;t.ep=!0;const c=s(t);fetch(t.href,c)}};H();const l=K.exports.jsx,p=K.exports.jsxs,_=K.exports.Fragment,A={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},z={MENU_OPTIONS:[{id:A.CREATE,text:"CREATE"},{id:A.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:l(_,{children:"\xA0"})},b=E(E({},A),z),$="xordle.herokuapp.com",X="wss://"+$;let i=null,T=null,I=null;const w={},P=(r,n)=>r.split(" ").forEach(s=>w[s]=n),j=()=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(I),I=null);const r=()=>{i.emit("PING")};return P("PING",()=>{console.log("Received server ping")}),P("SET_ID",n=>{!i||(i.id=n,T&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:T})),T=n,console.log("Socket initialized"))}),i=new WebSocket(X),i.emit=(n,s)=>{i?i.send(JSON.stringify({action:n,payload:s})):console.warn("No client found")},i.addEventListener("message",n=>{const{data:s}=n,{action:e,payload:t}=JSON.parse(s);w[e]&&w[e](t)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),j()}),I=setInterval(r,b.PING_DELAY),i},k={init:j,listen:P},q=r=>{const{children:n,onReconnect:s}=r;return m.exports.useEffect(()=>{k.init(s)},[]),l(_,{children:n})},Z=r=>{const{options:n,onClick:s,className:e}=r,t=()=>e?" "+e:"",c=o=>{const{id:u}=o.target;s&&u&&s(u)};return l("div",{className:"menu flex-col"+t(),onClick:c,children:n.map(({id:o,text:u})=>p("button",{id:o,children:[" ",u," "]},o))})};const L=r=>{switch(parseInt(r)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},Q=r=>r<33?"bg-red":r<66?"bg-yellow":"bg-green",D=r=>/^[a-zA-Z]$/.test(r);const ee=r=>{const{keys:n,onClick:s,disabled:e}=r,t=o=>{var u;e||(o.preventDefault(),o.target.id?s&&s({key:o.target.id}):(u=o.touches)==null||u.forEach(g=>{s&&s({key:g.id})}))},c=(o,u,g)=>{const a=b.KEYS["ROW_"+o];return p("div",{className:"flex keyboard-row",children:[u,a.map(h=>l(S,{letter:h,status:(n==null?void 0:n[h])>=0?n[h]:3,id:h},h)),g]})};return p("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:t,onClick:t,children:[c(0),c(1),c(2,l(S,{letter:"ENTER",status:3,id:"enter"}),l(S,{letter:l(_,{children:"\xAB"}),status:3,id:"backspace"}))]})},S=({letter:r,status:n,className:s,id:e})=>{let t=["flex keyboard-key",L(n),s||""].join(" ");return p("button",{className:t,id:e,children:[" ",r," "]})},ne=r=>{const{keys:n,history:s,inProgress:e,timeRemaining:t,keyboardDisabled:c,onKeyPress:o,current:u,room:g}=r,a=m.exports.useRef(null),h=m.exports.useRef(null);m.exports.useEffect(()=>{var f;(f=a==null?void 0:a.current)==null||f.focus()},[a]),m.exports.useEffect(()=>{h.current.scrollIntoView()},[u]);const d=f=>{if(!c)switch(f.key.toUpperCase()){case"ENTER":o&&o("ENTER");break;case"BACKSPACE":o&&o(null);break;default:D(f.key)&&o&&o(f.key.toUpperCase());break}},x=()=>s==null?void 0:s.map((f,N)=>s.length-1===N?l("div",{className:"flex game-board-last",children:f==null?void 0:f.map((C,v)=>m.exports.createElement(O,R(E({},C),{key:C+v,delay:v*60})))},f+N):l("div",{className:"flex",children:f==null?void 0:f.map((C,v)=>m.exports.createElement(O,R(E({},C),{key:C+v})))},f+N)),y=()=>{const f=[];for(let N=0;N<5;N++)f.push(l(O,{letter:u[N],status:u[N]?4:5},(u[N]||"")+N));return f};return p("div",{className:"game-board flex-col flex-fill ",onKeyDown:d,tabIndex:"0",ref:a,children:[p("label",{className:"floating-purple-text float-right",children:[" ",g," "]}),p("div",{className:"flex-col flex-fill overflow game-board-list",children:[x(),l("div",{className:"flex game-board-current",ref:h,children:e&&y()},s==null?void 0:s.length)]}),l(se,{className:"game-board-progress",progress:t}),l(ee,{keys:n,disabled:c,onClick:d})]})},se=({className:r,progress:n})=>{const s=n*100,e=[r||"","flex progress"].join(" "),t=["flex progress-bar",Q(s)].join(" "),c={width:s+"%"};return l("div",{className:e,children:l("div",{className:t,style:c})})},O=({letter:r,status:n,delay:s})=>{const[e,t]=m.exports.useState("bg-placeholder");m.exports.useEffect(()=>{s&&setTimeout(()=>{t(L(n))},s)},[n,s]);const c=["flex game-board-letter",s?e:L(n)].join(" ");return l("div",{className:"game-board-letter-wrapper",children:p("span",{className:c,children:[" ",r||b.BLANK," "]})})},re=r=>{const{room:n,children:s}=r,[e,t]=m.exports.useState(null),[c,o]=m.exports.useState([]),u=()=>(e==null?void 0:e.host)===i.id;m.exports.useEffect(()=>{i.room=n,i.emit("JOIN",{room:n}),k.listen("JOIN",t),k.listen("UPDATE",d=>{t(()=>((d==null?void 0:d.status)===1?o([]):(d==null?void 0:d.status)===0&&(d==null?void 0:d.turn)!==i.id&&o(d==null?void 0:d.current),d))})},[]);const g=()=>{u()&&i.emit("START")},a=()=>{u()&&i.emit("END")},h=d=>{d==="ENTER"?c.length===5?i.emit("ENTER_WORD"):o([]):o(d?x=>{const y=x.length<5?[...x,d]:x;return i.emit("SET_CURRENT",{current:y}),y}:x=>{if(x.length===0)return[];const y=[...x];return y.pop(),i.emit("SET_CURRENT",{current:y}),y})};return p("div",{className:"flex-col flex-fill game",children:[!(e!=null&&e.inProgress)&&s,(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&p("div",{className:"flex-col flex-fill game-end",children:[l("label",{className:"game-end-label",children:" Word: "}),p("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),l("button",{className:u()?"":"hidden",onClick:a,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&l(ne,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:c,onKeyPress:h,inProgress:e==null?void 0:e.turn,timeRemaining:e==null?void 0:e.timeRemaining,keyboardDisabled:(e==null?void 0:e.turn)!==(i==null?void 0:i.id),room:n}),!(e!=null&&e.inProgress)&&p("div",{className:"flex-col flex-fill game-lobby",children:[p("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),p("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),l("button",{className:"start-btn",onClick:g,children:u()?"START":"WAITING FOR HOST"})]})]})},te=()=>{const[r,n]=m.exports.useReducer(le,oe),s=m.exports.useRef(!1);m.exports.useEffect(()=>{k.listen("CREATE",a=>{n({type:"viewJoin",payload:{room:a}}),s.current=!1}),k.listen("VERIFY",a=>{s.current=!1,a&&n({type:"viewJoin",payload:{room:a}})})},[]);const e=a=>{if(!s.current)switch(a){case b.CREATE:s.current=!0,i.emit("CREATE");break;case b.JOIN:n({type:"viewCodeInput"});break;case b.PLAY:s.current=!0,i.emit("VERIFY",{room:r.room});break;default:console.log(a);return}},t=()=>{n({type:"viewMain"})},c=a=>{n({type:"setCodeInput",payload:a.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},o=()=>{var a;return p("div",{className:"flex-col",children:[l("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:r.room||"",onChange:c,spellCheck:"false",autoComplete:"false",autoFocus:!0}),l("button",{className:"flex play-btn "+(((a=r.room)==null?void 0:a.length)===5?"":"hidden"),onClick:()=>e(b.PLAY),children:l("img",{src:b.TRIANGLE_RIGHT})})]})};return l("div",{className:"app",children:l(q,{onReconnect:()=>{i.emit("VERIFY",{room:r.room})},children:(()=>{const a=r.view&&l("button",{className:"back-btn",onClick:t,children:" BACK "});switch(r.view){case"game":return l(re,{room:r.room,children:a});case"codeInput":return p("div",{className:"main-screen flex-col flex-fill",children:[a,l("label",{className:"flex title-label",children:" XORDLE "}),o()]});default:return p("div",{className:"main-screen flex-col flex-fill",children:[a,l("label",{className:"flex title-label",children:" XORDLE "}),l(Z,{options:b.MENU_OPTIONS,onClick:e})]})}})()})})},le=(r,n)=>{const{type:s,payload:e}=n;switch(s){case"viewMain":return R(E({},r),{view:null,room:null});case"viewJoin":return R(E({},r),{view:"game",room:e.room});case"viewCodeInput":return R(E({},r),{view:"codeInput"});case"setCodeInput":return R(E({},r),{room:e});default:return E({},r)}},oe={view:b.VIEW,room:null};F.render(l(V.StrictMode,{children:l(te,{})}),document.getElementById("root"));
