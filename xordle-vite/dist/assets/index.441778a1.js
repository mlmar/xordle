var U=Object.defineProperty,j=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var K=(n,s,e)=>s in n?U(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e,N=(n,s)=>{for(var e in s||(s={}))J.call(s,e)&&K(n,e,s[e]);if(_)for(var e of _(s))W.call(s,e)&&K(n,e,s[e]);return n},b=(n,s)=>j(n,Y(s));import{j as P,r as p,R as M,a as B}from"./vendor.2d6b8063.js";const F=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerpolicy&&(t.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?t.credentials="include":r.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(r){if(r.ep)return;r.ep=!0;const t=e(r);fetch(r.href,t)}};F();const o=P.exports.jsx,m=P.exports.jsxs,L=P.exports.Fragment,S={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},V={MENU_OPTIONS:[{id:S.CREATE,text:"CREATE"},{id:S.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:o(L,{children:"\xA0"})},E=N(N({},S),V),H="xordle.herokuapp.com",z="wss://"+H;let u=null,k=null;const O={},A=(n,s)=>n.split(" ").forEach(e=>O[e]=s),G=()=>{u&&(console.warn("Client already iniitialized. Removing existing client..."),u.close(),clearInterval(k),k=null);const n=()=>{u.emit("PING")};return A("PING",()=>{console.log("Received server ping")}),A("SET_ID",s=>{u&&(u.id=s),console.log("Socket initialized")}),u=new WebSocket(z),u.emit=(s,e)=>{u?u.send(JSON.stringify({action:s,payload:e})):console.warn("No client found")},u.addEventListener("message",s=>{const{data:e}=s,{action:c,payload:r}=JSON.parse(e);O[c]&&O[c](r)}),u.addEventListener("close",s=>{console.warn("Client closed. Reconnecting..."),G()}),k=setInterval(n,E.PING_DELAY),u},C={init:G,listen:A},$=n=>{const{children:s,onReconnect:e}=n;return p.exports.useEffect(()=>{C.init(e)},[]),o(L,{children:s})},X=n=>{const{options:s,onClick:e,className:c}=n,r=()=>c?" "+c:"",t=i=>{const{id:f}=i.target;e&&f&&e(f)};return o("div",{className:"menu flex-col"+r(),onClick:t,children:s.map(({id:i,text:f})=>m("button",{id:i,children:[" ",f," "]},i))})};const w=n=>{switch(parseInt(n)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},q=n=>n<33?"bg-red":n<66?"bg-yellow":"bg-green",Z=n=>/^[a-zA-Z]$/.test(n);const Q=n=>{const{keys:s,onClick:e,disabled:c}=n,r=i=>{var f;c||(i.preventDefault(),i.target.id?e&&e({key:i.target.id}):(f=i.touches)==null||f.forEach(a=>{e&&e({key:a.id})}))},t=(i,f,a)=>{const y=E.KEYS["ROW_"+i];return m("div",{className:"flex keyboard-row",children:[f,y.map(l=>o(T,{letter:l,status:(s==null?void 0:s[l])>=0?s[l]:3,id:l},l)),a]})};return m("div",{className:"keyboard flex-col "+(c?"disabled":""),onTouchEnd:r,onClick:r,children:[t(0),t(1),t(2,o(T,{letter:"ENTER",status:3,id:"enter"}),o(T,{letter:o(L,{children:"\xAB"}),status:3,id:"backspace"}))]})},T=({letter:n,status:s,className:e,id:c})=>{let r=["flex keyboard-key",w(s),e||""].join(" ");return m("button",{className:r,id:c,children:[" ",n," "]})},D=n=>{const{keys:s,history:e,inProgress:c,timeRemaining:r,keyboardDisabled:t,onKeyPress:i,current:f}=n,a=p.exports.useRef(null),y=p.exports.useRef(null);p.exports.useEffect(()=>{var d;(d=a==null?void 0:a.current)==null||d.focus()},[a]),p.exports.useEffect(()=>{y.current.scrollIntoView()},[f]);const l=d=>{if(!t)switch(d.key.toUpperCase()){case"ENTER":i&&i("ENTER");break;case"BACKSPACE":i&&i(null);break;default:Z(d.key)&&i&&i(d.key.toUpperCase());break}},g=()=>e==null?void 0:e.map((d,h)=>e.length-1===h?o("div",{className:"flex game-board-last",children:d==null?void 0:d.map((R,v)=>p.exports.createElement(I,b(N({},R),{key:R+v,delay:v*60})))},d+h):o("div",{className:"flex",children:d==null?void 0:d.map((R,v)=>p.exports.createElement(I,b(N({},R),{key:R+v})))},d+h)),x=()=>{const d=[];for(let h=0;h<5;h++)d.push(o(I,{letter:f[h],status:f[h]?4:5},(f[h]||"")+h));return d};return m("div",{className:"game-board flex-col flex-fill ",onKeyDown:l,tabIndex:"0",ref:a,children:[m("div",{className:"flex-col flex-fill overflow game-board-list",children:[g(),o("div",{className:"flex game-board-current",ref:y,children:c&&x()},e==null?void 0:e.length)]}),o(ee,{className:"game-board-progress",progress:r}),o(Q,{keys:s,disabled:t,onClick:l})]})},ee=({className:n,progress:s})=>{const e=s*100,c=[n||"","flex progress"].join(" "),r=["flex progress-bar",q(e)].join(" "),t={width:e+"%"};return o("div",{className:c,children:o("div",{className:r,style:t})})},I=({letter:n,status:s,delay:e})=>{const[c,r]=p.exports.useState("bg-placeholder");p.exports.useEffect(()=>{e&&setTimeout(()=>{r(w(s))},e)},[s,e]);const t=["flex game-board-letter",e?c:w(s)].join(" ");return o("div",{className:"game-board-letter-wrapper",children:m("span",{className:t,children:[" ",n||E.BLANK," "]})})},se=n=>{const{room:s}=n,[e,c]=p.exports.useState(null),[r,t]=p.exports.useState([]),i=()=>(e==null?void 0:e.host)===u.id;p.exports.useEffect(()=>{u.room=s,u.emit("JOIN",{room:s}),C.listen("JOIN",c),C.listen("UPDATE",l=>{c(g=>(console.log(l==null?void 0:l.status),(l==null?void 0:l.status)===1?t([]):(l==null?void 0:l.status)===0&&(l==null?void 0:l.turn)!==u.id&&t(l==null?void 0:l.current),l))})},[]);const f=()=>{i()&&u.emit("START")},a=()=>{i()&&u.emit("END")},y=l=>{l==="ENTER"?r.length===5?u.emit("ENTER_WORD"):t([]):t(l?g=>{const x=g.length<5?[...g,l]:g;return u.emit("SET_CURRENT",{current:x}),x}:g=>{if(g.length===0)return[];const x=[...g];return x.pop(),u.emit("SET_CURRENT",{current:x}),x})};return m("div",{className:"flex-col flex-fill game",children:[(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&m("div",{className:"flex-col flex-fill game-end",children:[o("label",{className:"game-end-label",children:" Word: "}),m("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),o("button",{className:i()?"":"hidden",onClick:a,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&o(D,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:r,onKeyPress:y,inProgress:e==null?void 0:e.turn,timeRemaining:e==null?void 0:e.timeRemaining,keyboardDisabled:(e==null?void 0:e.turn)!==(u==null?void 0:u.id)}),!(e!=null&&e.inProgress)&&m("div",{className:"flex-col flex-fill game-lobby",children:[m("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),m("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),o("button",{className:"start-btn",onClick:f,children:i()?"START":"WAITING FOR HOST"})]})]})},ne=()=>{const[n,s]=p.exports.useReducer(re,te),e=p.exports.useRef(!1);p.exports.useEffect(()=>{C.listen("CREATE",a=>{s({type:"viewJoin",payload:{room:a}}),e.current=!1}),C.listen("VERIFY",a=>{e.current=!1,a&&s({type:"viewJoin",payload:{room:a}})})},[]);const c=a=>{if(!e.current)switch(a){case E.CREATE:e.current=!0,u.emit("CREATE");break;case E.JOIN:s({type:"viewCodeInput"});break;case E.PLAY:e.current=!0,u.emit("VERIFY",{room:n.room});break;default:console.log(a);return}},r=a=>{s({type:"setCodeInput",payload:a.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},t=()=>{var a;return m("div",{className:"flex-col",children:[o("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:n.room||"",onChange:r,spellCheck:"false",autoComplete:"false",autoFocus:!0}),o("button",{className:"flex play-btn "+(((a=n.room)==null?void 0:a.length)===5?"":"hidden"),onClick:()=>c(E.PLAY),children:o("img",{src:E.TRIANGLE_RIGHT})})]})};return o("div",{className:"app",children:o($,{onReconnect:()=>{u.emit("VERIFY",{room:n.room})},children:(()=>{switch(n.view){case"game":return o(se,{room:n.room});default:return m("div",{className:"main-screen flex-col flex-fill",children:[o("label",{className:"flex title-label",children:" XORDLE "}),n.view!=="codeInput"?o(X,{options:E.MENU_OPTIONS,onClick:c}):t()]})}})()})})},re=(n,s)=>{const{type:e,payload:c}=s;switch(e){case"viewMain":return b(N({},n),{view:null});case"viewJoin":return b(N({},n),{view:"game",room:c.room});case"viewCodeInput":return b(N({},n),{view:"codeInput"});case"setCodeInput":return b(N({},n),{room:c});default:return N({},n)}},te={view:E.VIEW,room:null};M.render(o(B.StrictMode,{children:o(ne,{})}),document.getElementById("root"));
