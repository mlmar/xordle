var B=Object.defineProperty,M=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var U=(r,s,n)=>s in r?B(r,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[s]=n,E=(r,s)=>{for(var n in s||(s={}))W.call(s,n)&&U(r,n,s[n]);if(G)for(var n of G(s))Y.call(s,n)&&U(r,n,s[n]);return r},C=(r,s)=>M(r,J(s));import{j as K,r as m,R as V,a as F}from"./vendor.2d6b8063.js";const H=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function n(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerpolicy&&(c.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?c.credentials="include":t.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function e(t){if(t.ep)return;t.ep=!0;const c=n(t);fetch(t.href,c)}};H();const l=K.exports.jsx,p=K.exports.jsxs,_=K.exports.Fragment,A={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},z={MENU_OPTIONS:[{id:A.CREATE,text:"CREATE"},{id:A.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:l(_,{children:"\xA0"})},b=E(E({},A),z),$="xordle.herokuapp.com",X="wss://"+$;let i=null,T=null,I=null;const w={},P=(r,s)=>r.split(" ").forEach(n=>w[n]=s),j=()=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(I),I=null);const r=()=>{i.emit("PING")};return P("PING",()=>{console.log("Received server ping")}),P("SET_ID",s=>{!i||(i.id=s,T&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:T})),T=s,console.log("Socket initialized"))}),i=new WebSocket(X),i.emit=(s,n)=>{i?i.send(JSON.stringify({action:s,payload:n})):console.warn("No client found")},i.addEventListener("message",s=>{const{data:n}=s,{action:e,payload:t}=JSON.parse(n);w[e]&&w[e](t)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),j()}),I=setInterval(r,b.PING_DELAY),i},R={init:j,listen:P},q=r=>{const{children:s}=r;return m.exports.useEffect(()=>{R.init()},[]),l(_,{children:s})},Z=r=>{const{options:s,onClick:n,className:e}=r,t=()=>e?" "+e:"",c=o=>{const{id:u}=o.target;n&&u&&n(u)};return l("div",{className:"menu flex-col"+t(),onClick:c,children:s.map(({id:o,text:u})=>p("button",{id:o,children:[" ",u," "]},o))})};const L=r=>{switch(parseInt(r)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},Q=r=>r<33?"bg-red":r<66?"bg-yellow":"bg-green",D=r=>/^[a-zA-Z]$/.test(r);const ee=r=>{const{keys:s,onClick:n,disabled:e}=r,t=o=>{var u;e||(o.preventDefault(),o.target.id?n&&n({key:o.target.id}):(u=o.touches)==null||u.forEach(a=>{n&&n({key:a.id})}))},c=(o,u,a)=>{const g=b.KEYS["ROW_"+o];return p("div",{className:"flex keyboard-row",children:[u,g.map(h=>l(S,{letter:h,status:(s==null?void 0:s[h])>=0?s[h]:3,id:h},h)),a]})};return p("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:t,onClick:t,children:[c(0),c(1),c(2,l(S,{letter:"ENTER",status:3,id:"enter"}),l(S,{letter:l(_,{children:"\xAB"}),status:3,id:"backspace"}))]})},S=({letter:r,status:s,className:n,id:e})=>{let t=["flex keyboard-key",L(s),n||""].join(" ");return p("button",{className:t,id:e,children:[" ",r," "]})},se=r=>{const{keys:s,history:n,inProgress:e,timeRemaining:t,keyboardDisabled:c,onKeyPress:o,current:u,room:a}=r,g=m.exports.useRef(null),h=m.exports.useRef(null);m.exports.useEffect(()=>{var f;(f=g==null?void 0:g.current)==null||f.focus()},[g]),m.exports.useEffect(()=>{h.current.scrollIntoView()},[u]);const d=f=>{if(!c)switch(f.key.toUpperCase()){case"ENTER":o&&o("ENTER");break;case"BACKSPACE":o&&o(null);break;default:D(f.key)&&o&&o(f.key.toUpperCase());break}},x=()=>n==null?void 0:n.map((f,N)=>n.length-1===N?l("div",{className:"flex game-board-last",children:f==null?void 0:f.map((k,v)=>m.exports.createElement(O,C(E({},k),{key:k+v,delay:v*60})))},f+N):l("div",{className:"flex",children:f==null?void 0:f.map((k,v)=>m.exports.createElement(O,C(E({},k),{key:k+v})))},f+N)),y=()=>{const f=[];for(let N=0;N<5;N++)f.push(l(O,{letter:u[N],status:u[N]?4:5},(u[N]||"")+N));return f};return p("div",{className:"game-board flex-col flex-fill ",onKeyDown:d,tabIndex:"0",ref:g,children:[p("label",{className:"floating-purple-text float-right",children:[" ",a," "]}),p("div",{className:"flex-col flex-fill overflow game-board-list",children:[x(),l("div",{className:"flex game-board-current",ref:h,children:e&&y()},n==null?void 0:n.length)]}),l(ne,{className:"game-board-progress",progress:t}),l(ee,{keys:s,disabled:c,onClick:d})]})},ne=({className:r,progress:s})=>{const n=s*100,e=[r||"","flex progress"].join(" "),t=["flex progress-bar",Q(n)].join(" "),c={width:n+"%"};return l("div",{className:e,children:l("div",{className:t,style:c})})},O=({letter:r,status:s,delay:n})=>{const[e,t]=m.exports.useState("bg-placeholder");m.exports.useEffect(()=>{n&&setTimeout(()=>{t(L(s))},n)},[s,n]);const c=["flex game-board-letter",n?e:L(s)].join(" ");return l("div",{className:"game-board-letter-wrapper",children:p("span",{className:c,children:[" ",r||b.BLANK," "]})})},re=r=>{const{room:s,children:n}=r,[e,t]=m.exports.useState(null),[c,o]=m.exports.useState([]),u=()=>(e==null?void 0:e.host)===i.id;m.exports.useEffect(()=>{i.room=s,i.emit("JOIN",{room:s}),R.listen("JOIN",t),R.listen("UPDATE",d=>{t(()=>((d==null?void 0:d.status)===1?o([]):(d==null?void 0:d.status)===0&&(d==null?void 0:d.turn)!==i.id&&o(d==null?void 0:d.current),d))})},[]);const a=()=>{u()&&i.emit("START")},g=()=>{u()&&i.emit("END")},h=d=>{d==="ENTER"?c.length===5?i.emit("ENTER_WORD"):o([]):o(d?x=>{const y=x.length<5?[...x,d]:x;return i.emit("SET_CURRENT",{current:y}),y}:x=>{if(x.length===0)return[];const y=[...x];return y.pop(),i.emit("SET_CURRENT",{current:y}),y})};return p("div",{className:"flex-col flex-fill game",children:[!(e!=null&&e.inProgress)&&n,(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&p("div",{className:"flex-col flex-fill game-end",children:[l("label",{className:"game-end-label",children:" Word: "}),p("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),l("button",{className:u()?"":"hidden",onClick:g,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&l(se,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:c,onKeyPress:h,inProgress:e==null?void 0:e.turn,timeRemaining:e==null?void 0:e.timeRemaining,keyboardDisabled:(e==null?void 0:e.turn)!==(i==null?void 0:i.id),room:s}),!(e!=null&&e.inProgress)&&p("div",{className:"flex-col flex-fill game-lobby",children:[p("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),p("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),l("button",{className:"start-btn",onClick:a,children:u()?"START":"WAITING FOR HOST"})]})]})},te=()=>{const[r,s]=m.exports.useReducer(le,oe),n=m.exports.useRef(!1);m.exports.useEffect(()=>{R.listen("CREATE",a=>{s({type:"viewJoin",payload:{room:a}}),n.current=!1}),R.listen("VERIFY",a=>{n.current=!1,a&&s({type:"viewJoin",payload:{room:a}})}),R.listen("RECONNECT",a=>{a||s({type:"viewMain "})})},[]);const e=a=>{if(!n.current)switch(a){case b.CREATE:n.current=!0,i.emit("CREATE");break;case b.JOIN:s({type:"viewCodeInput"});break;case b.PLAY:n.current=!0,i.emit("VERIFY",{room:r.room});break;default:console.log(a);return}},t=()=>{i.emit("LEAVE"),s({type:"viewMain"})},c=a=>{s({type:"setCodeInput",payload:a.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},o=()=>{var a;return p("div",{className:"flex-col",children:[l("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:r.room||"",onChange:c,spellCheck:"false",autoComplete:"false",autoFocus:!0}),l("button",{className:"flex play-btn "+(((a=r.room)==null?void 0:a.length)===5?"":"hidden"),onClick:()=>e(b.PLAY),children:l("img",{src:b.TRIANGLE_RIGHT})})]})};return l("div",{className:"app",children:l(q,{children:(()=>{const a=r.view&&l("button",{className:"back-btn",onClick:t,children:" BACK "});switch(r.view){case"game":return l(re,{room:r.room,children:a});case"codeInput":return p("div",{className:"main-screen flex-col flex-fill",children:[a,l("label",{className:"flex title-label",children:" XORDLE "}),o()]});default:return p("div",{className:"main-screen flex-col flex-fill",children:[a,l("label",{className:"flex title-label",children:" XORDLE "}),l(Z,{options:b.MENU_OPTIONS,onClick:e})]})}})()})})},le=(r,s)=>{const{type:n,payload:e}=s;switch(n){case"viewMain":return C(E({},r),{view:null,room:null});case"viewJoin":return C(E({},r),{view:"game",room:e.room});case"viewCodeInput":return C(E({},r),{view:"codeInput"});case"setCodeInput":return C(E({},r),{room:e});default:return E({},r)}},oe={view:b.VIEW,room:null};V.render(l(F.StrictMode,{children:l(te,{})}),document.getElementById("root"));
