var K=Object.defineProperty,j=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var L=(n,t,e)=>t in n?K(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,N=(n,t)=>{for(var e in t||(t={}))G.call(t,e)&&L(n,e,t[e]);if(w)for(var e of w(t))M.call(t,e)&&L(n,e,t[e]);return n},b=(n,t)=>j(n,U(t));import{j as O,r as p,R as J,a as W}from"./vendor.2d6b8063.js";const Y=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}};Y();const l=O.exports.jsx,m=O.exports.jsxs,A=O.exports.Fragment,S={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},B={MENU_OPTIONS:[{id:S.CREATE,text:"CREATE"},{id:S.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:3e4,BLANK:l(A,{children:"\xA0"})},x=N(N({},S),B),P="xordle.onrender.com",V="https://"+P,F="wss://"+P;let d=null;const v={},_=(n,t)=>v[n]=t,H=()=>{if(d){console.warn("Socket already iniitialized");return}return _("SET_ID",n=>{d&&(d.id=n),console.log("Socket Initialized")}),d=new WebSocket(F),d.emit=(n,t)=>{d.send(JSON.stringify({action:n,payload:t}))},d.addEventListener("message",n=>{const{data:t}=n,{action:e,payload:o}=JSON.parse(t);v[e]&&v[e](o)}),d},C={init:H,listen:_},z=n=>{const{children:t,onDisconnect:e}=n;return p.exports.useEffect(()=>{const o=()=>{fetch(V+"/ping").then(r=>r.json()).then(()=>console.log("Pinged Server")).catch(e)};try{C.init()}catch(r){handleDisconenct(r)}o(),setInterval(o,x.PING_DELAY)},[]),l(A,{children:t})},$=n=>{const{options:t,onClick:e,className:o}=n,r=()=>o?" "+o:"",s=c=>{const{id:f}=c.target;e&&f&&e(f)};return l("div",{className:"menu flex-col"+r(),onClick:s,children:t.map(({id:c,text:f})=>m("button",{id:c,children:[" ",f," "]},c))})};const I=n=>{switch(parseInt(n)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}};const X=n=>{const{keys:t,onClick:e,disabled:o}=n,r=c=>{var i,y;if(o)return;c.preventDefault();const f=((y=(i=c.touches)==null?void 0:i[0])==null?void 0:y.target.id)||c.target.id;e&&e({key:f})},s=(c,f,i)=>{const y=x.KEYS["ROW_"+c];return m("div",{className:"flex keyboard-row",children:[f,y.map(u=>l(k,{letter:u,status:(t==null?void 0:t[u])>=0?t[u]:3,id:u},u)),i]})};return m("div",{className:"keyboard flex-col "+(o?"disabled":""),onTouchEnd:r,onClick:r,children:[s(0),s(1),s(2,l(k,{letter:"ENTER",status:3,id:"enter"}),l(k,{letter:l(A,{children:"\xAB"}),status:3,id:"backspace"}))]})},k=({letter:n,status:t,className:e,id:o})=>{let r=["flex keyboard-key",I(t),e||""].join(" ");return m("button",{className:r,id:o,children:[" ",n," "]})},q=n=>{const{keys:t,history:e,inProgress:o,keyboardDisabled:r,onKeyPress:s,current:c}=n,f=p.exports.useRef(null),i=p.exports.useRef(null);p.exports.useEffect(()=>{var a;(a=f==null?void 0:f.current)==null||a.focus()},[f]),p.exports.useEffect(()=>{i.current.scrollIntoView()},[c]);const y=a=>{if(!r)switch(a.key.toUpperCase()){case"ENTER":s&&s("ENTER");break;case"BACKSPACE":s&&s(null);break;default:/^[a-zA-Z]$/.test(a.key)&&s&&s(a.key);break}},u=()=>e==null?void 0:e.map((a,E)=>e.length-1===E?l("div",{className:"flex game-board-last",children:a==null?void 0:a.map((R,g)=>p.exports.createElement(T,b(N({},R),{key:R+g,delay:g*60})))},a+E):l("div",{className:"flex",children:a==null?void 0:a.map((R,g)=>p.exports.createElement(T,b(N({},R),{key:R+g})))},a+E)),h=()=>{const a=[];for(let E=0;E<5;E++)a.push(l(T,{letter:c[E],status:c[E]?4:5},(c[E]||"")+E));return a};return m("div",{className:"game-board flex-col flex-fill ",onKeyDown:y,tabIndex:"0",ref:f,children:[m("div",{className:"flex-col flex-fill overflow game-board-list",children:[u(),l("div",{className:"flex game-board-current",ref:i,children:o&&h()},e==null?void 0:e.length)]}),l(X,{keys:t,disabled:r,onClick:y})]})},T=({letter:n,status:t,delay:e})=>{const[o,r]=p.exports.useState("");p.exports.useEffect(()=>{e&&setTimeout(()=>{r(I(t))},e)},[t,e]);const s=["flex game-board-letter",e?o:I(t)].join(" ");return l("div",{className:"game-board-letter-wrapper",children:m("span",{className:s,children:[" ",n||x.BLANK," "]})})},Z=n=>{const{room:t}=n,[e,o]=p.exports.useState(null),[r,s]=p.exports.useState([]),c=()=>(e==null?void 0:e.host)===d.id;p.exports.useEffect(()=>{d.emit("JOIN",{room:t}),C.listen("JOIN",o),C.listen("UPDATE",u=>{o(u),s(h=>h.join("")!==(u==null?void 0:u.current.join(""))?u==null?void 0:u.current:h)})},[]);const f=()=>{c()&&d.emit("START")},i=()=>{c()&&d.emit("END")},y=u=>{u==="ENTER"?(s([]),d.emit("ENTER_WORD")):u?(s(h=>h.length<5?[...h,u.toUpperCase()]:h),d.emit("PRESS_LETTER",{letter:u})):(s(h=>{let a=[...h];return a.pop(),a}),d.emit("REMOVE_LETTER"))};return m("div",{className:"flex-col flex-fill game",children:[(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&m("div",{className:"flex-col flex-fill game-end",children:[l("label",{className:"game-end-label",children:" Word: "}),m("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),l("button",{className:c()?"":"hidden",onClick:i,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&l(q,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:r,onKeyPress:y,inProgress:e==null?void 0:e.turn,keyboardDisabled:(e==null?void 0:e.turn)!==(d==null?void 0:d.id)}),!(e!=null&&e.inProgress)&&m("div",{className:"flex-col flex-fill game-lobby",children:[m("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),m("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),l("button",{className:"start-btn",onClick:f,children:c()?"START":"WAITING FOR HOST"})]})]})},Q=()=>{const[n,t]=p.exports.useReducer(D,ee),e=p.exports.useRef(!1);p.exports.useEffect(()=>{C.listen("CREATE",i=>{t({type:"viewJoin",payload:{room:i}}),e.current=!1}),C.listen("VERIFY",i=>{e.current=!1,i&&t({type:"viewJoin",payload:{room:i}})})},[]);const o=i=>{if(!e.current)switch(i){case x.CREATE:e.current=!0,d.emit("CREATE");break;case x.JOIN:t({type:"viewCodeInput"});break;case x.PLAY:e.current=!0,d.emit("VERIFY",{room:n.room});break;default:console.log(i);return}},r=i=>{t({type:"setCodeInput",payload:i.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},s=()=>{var i;return m("div",{className:"flex-col",children:[l("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:n.room||"",onChange:r,spellCheck:"false",autoComplete:"false",autoFocus:!0}),l("button",{className:"flex play-btn "+(((i=n.room)==null?void 0:i.length)===5?"":"hidden"),onClick:()=>o(x.PLAY),children:l("img",{src:x.TRIANGLE_RIGHT})})]})};return l("div",{className:"app",children:l(z,{onDisconnect:()=>{t({type:"viewMain"})},children:(()=>{switch(n.view){case"game":return l(Z,{room:n.room});default:return m("div",{className:"main-screen flex-col flex-fill",children:[l("label",{className:"flex title-label",children:" XORDLE "}),n.view!=="codeInput"?l($,{options:x.MENU_OPTIONS,onClick:o}):s()]})}})()})})},D=(n,t)=>{const{type:e,payload:o}=t;switch(e){case"viewMain":return b(N({},n),{view:null});case"viewJoin":return b(N({},n),{view:"game",room:o.room});case"viewCodeInput":return b(N({},n),{view:"codeInput"});case"setCodeInput":return b(N({},n),{room:o});default:return N({},n)}},ee={view:x.VIEW,room:null};J.render(l(W.StrictMode,{children:l(Q,{})}),document.getElementById("root"));
