var V=Object.defineProperty,z=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var J=(n,t,s)=>t in n?V(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s,E=(n,t)=>{for(var s in t||(t={}))$.call(t,s)&&J(n,s,t[s]);if(B)for(var s of B(t))X.call(t,s)&&J(n,s,t[s]);return n},y=(n,t)=>z(n,H(t));import{j,r as d,R as q,a as Z}from"./vendor.8cd058a3.js";const Q=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))e(c);new MutationObserver(c=>{for(const l of c)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&e(f)}).observe(document,{childList:!0,subtree:!0});function s(c){const l={};return c.integrity&&(l.integrity=c.integrity),c.referrerpolicy&&(l.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?l.credentials="include":c.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function e(c){if(c.ep)return;c.ep=!0;const l=s(c);fetch(c.href,l)}};Q();const o=j.exports.jsx,u=j.exports.jsxs,O=j.exports.Fragment,G={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},D={MENU_OPTIONS:[{id:G.CREATE,text:"CREATE"},{id:G.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:o(O,{children:"\xA0"})},R=E(E({},G),D),ee="xordle.herokuapp.com",te="wss://"+ee;let i=null,L=null;const K={},M=(n,t)=>n.split(" ").forEach(s=>K[s]=e=>{t(e)}),W=()=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(L),L=null);const n=()=>{i.emit("PING")};return M("PING",()=>{console.log("Received server ping")}),M("SET_ID",t=>{if(!i)return;i.id=t;let s=localStorage.getItem("xordle_id");s&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:s}));let e=localStorage.getItem("xordle_name");e&&i.setName(e),localStorage.setItem("xordle_id",t),console.log("Socket initialized")}),i=new WebSocket(te),i.emit=(t,s)=>{i?i.send(JSON.stringify({action:t,payload:s})):console.warn("No client found")},i.setName=t=>{localStorage.setItem("xordle_name",t),i.emit("SET_NAME",{name:t})},i.addEventListener("message",t=>{const{data:s}=t,{action:e,payload:c}=JSON.parse(s);K[e]&&K[e](c)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),W()}),L=setInterval(n,R.PING_DELAY),i},k={init:W,listen:M},se=n=>{const{children:t}=n;return d.exports.useEffect(()=>{k.init()},[]),o(O,{children:t})},ne=n=>{const{options:t,onClick:s,className:e}=n,c=()=>e?" "+e:"",l=f=>{const{id:a}=f.target;s&&a&&s(a)};return o("div",{className:"menu flex-col"+c(),onClick:l,children:t.map(({id:f,text:a})=>u("button",{id:f,children:[" ",a," "]},f))})};const Y=n=>{switch(parseInt(n)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},le=n=>n<33?"bg-red":n<66?"bg-yellow":"bg-green",re=n=>/^[a-zA-Z]$/.test(n);const oe=n=>{const{keys:t,onClick:s,disabled:e}=n,c=a=>{var h,b;if(!e)if((h=a.touches)!=null&&h.length){let N=[];for(let r of a.touches)r&&N.push(r);N=N[N.length-1],((b=N==null?void 0:N.target)==null?void 0:b.id)&&s&&s({key:N.target.id})}else a.target.id&&s&&s({key:a.target.id})},l=(a,h,b)=>{const N=R.KEYS["ROW_"+a];return u("div",{className:"flex keyboard-row",children:[h,N.map(r=>o(_,{letter:r,status:(t==null?void 0:t[r])>=0?t[r]:3,id:r},r)),b]})},f=a=>a.preventDefault();return u("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:f,onTouchStart:c,onMouseUp:c,children:[l(0),l(1),l(2,o(_,{letter:"ENTER",status:3,id:"enter"}),o(_,{letter:o(O,{children:"\xAB"}),status:3,id:"backspace"}))]})},_=({letter:n,status:t,className:s,id:e})=>{let c=["flex keyboard-key",Y(t),s||""].join(" ");return o("span",{className:"flex keyboard-key-container",id:e,children:u("button",{className:c,id:e,children:[" ",n," "]})})},ce=n=>{const{keys:t,history:s,inProgress:e,timeRemaining:c,showTimeRemaining:l,keyboardDisabled:f,onKeyPress:a,current:h,room:b,name:N,message:r}=n,g=d.exports.useRef(null),S=d.exports.useRef(null);d.exports.useEffect(()=>{var m;(m=g==null?void 0:g.current)==null||m.focus()},[g]),d.exports.useEffect(()=>{S.current.scrollIntoView()},[h]);const A=m=>{if(!f)switch(m.key.toUpperCase()){case"ENTER":a&&a("ENTER");break;case"BACKSPACE":a&&a(null);break;default:re(m.key)&&a&&a(m.key.toUpperCase());break}},w=()=>s==null?void 0:s.map((m,x)=>s.length-1===x?o("div",{className:"flex game-board-last",children:m==null?void 0:m.map((T,v)=>d.exports.createElement(U,y(E({},T),{key:T+v,delay:v*60})))},m+x):o("div",{className:"flex",children:m==null?void 0:m.map((T,v)=>d.exports.createElement(U,y(E({},T),{key:T+v})))},m+x)),P=()=>{const m=[];for(let x=0;x<5;x++)m.push(o(U,{letter:h[x],status:h[x]?4:5},(h[x]||"")+x));return m};return u("div",{className:"game-board flex-col flex-fill ",onKeyDown:A,tabIndex:"0",ref:g,children:[u("label",{className:"floating-purple-text float-left",children:[" ",r," "]}),u("label",{className:"floating-purple-text float-right",children:[" ",b," "]}),u("div",{className:"flex-col flex-fill overflow game-board-list",children:[w(),o("div",{className:"flex game-board-current",ref:S,children:e&&P()},s==null?void 0:s.length)]}),l&&o(ie,{className:"game-board-progress",progress:c}),o(oe,{keys:t,disabled:f,onClick:A})]})},ie=({className:n,progress:t})=>{const s=t*100,e=[n||"","flex progress"].join(" "),c=["flex progress-bar",le(s)].join(" "),l={width:s+"%"};return o("div",{className:e,children:o("div",{className:c,style:l})})},U=({letter:n,status:t,delay:s})=>{const[e,c]=d.exports.useState("bg-placeholder active"),l=d.exports.useRef(null);d.exports.useEffect(()=>{if(s)return l.current=setTimeout(()=>{c(Y(t))},s),()=>clearTimeout(l.current)},[t,s]);const f=["flex game-board-letter",s?e:Y(t)].join(" ");return o("div",{className:"game-board-letter-wrapper",children:u("span",{className:f,children:[" ",n||R.BLANK," "]})})},ae=n=>{const{room:t,children:s}=n,[e,c]=d.exports.useState(null),[l,f]=d.exports.useState(null),[a,h]=d.exports.useState([]),[b,N]=d.exports.useState(!1),[r,g]=d.exports.useState(null),S=()=>(e==null?void 0:e.host)===i.id,A=p=>{c(p.room),f(p.player)};d.exports.useEffect(()=>{i.room=t,i.emit("JOIN",{room:t}),k.listen("JOIN",c),k.listen("UPDATE",c),k.listen("PLAYER_UPDATE",f),k.listen("SERVER_UPDATE",A),k.listen("SETTINGS_UPDATE",g)},[]),d.exports.useEffect(()=>{((l==null?void 0:l.correct)===!1||(l==null?void 0:l.correct)===!0)&&h([])},[l]),d.exports.useEffect(()=>{(e==null?void 0:e.status)===0&&h([])},[e]);const w=()=>{N(p=>!p)},P=p=>{const C=y(E({},r),{[p.target.id]:p.target.checked});i.emit("SETTINGS_UPDATE",{settings:C})},m=()=>u("div",{className:"flex flex-col flex-fill settings-panel",children:[o("button",{className:"back-btn",onClick:w,children:" BACK "}),r&&Object.keys(r).map(p=>u("div",{className:"flex flex-middle",children:[o("input",{type:"checkbox",className:"flex",checked:r[p],id:p,onChange:P}),u("label",{className:"flex flex-middle",htmlFor:p,children:[" ",p," "]})]},p))]}),x=()=>{S()&&i.emit("START")},T=()=>{S()&&i.emit("END")},v=p=>{p==="ENTER"?(a.length===5&&i.emit("ENTER_WORD",{current:a}),h([])):h(p?C=>C.length<5?[...C,p]:C:C=>{if(C.length===0)return[];const I=[...C];return I.pop(),I})};return u("div",{className:"flex-col flex-fill game",children:[!(e!=null&&e.status)>0&&!b&&s,(e==null?void 0:e.status)===2&&u("div",{className:"flex-col flex-fill game-end",children:[u("label",{className:"game-end-word underline",children:[" ",e==null?void 0:e.word," "]}),e==null?void 0:e.winOrder.map(({name:p,attempts:C},I)=>{const F=C>0?"TRIES":"TRY";return I<4?u("label",{className:"game-end-word",children:[" #",I+1," - ",p," (",C," ",F,")"]},I+p):null}),o("button",{className:S()?"":"hidden",onClick:T,children:" RESTART "})]}),(e==null?void 0:e.status)>0&&o(ce,{keys:l==null?void 0:l.keys,history:l==null?void 0:l.history,current:a,onKeyPress:v,inProgress:l==null?void 0:l.inProgress,timeRemaining:l==null?void 0:l.timeRemaining,showTimeRemaining:r==null?void 0:r["GUESS TIMER"],keyboardDisabled:!(l!=null&&l.inProgress),name:(l==null?void 0:l.name)||i.name,room:t,message:(r!=null&&r["GAME TIMER"]?"["+(e==null?void 0:e.timeRemaining)+"] ":"")+(e==null?void 0:e.message)}),(e==null?void 0:e.status)===0&&u("div",{className:"flex-col flex-fill game-lobby",children:[o("button",{className:"flex floating-purple-text float-right",onClick:w,children:" SETTINGS "}),u("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),b?m():u(O,{children:[u("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),o("button",{className:"start-btn",onClick:x,children:S()?"START":"WAITING FOR HOST"})]})]})]})},ue=()=>{const[n,t]=d.exports.useReducer(de,fe),s=d.exports.useRef(!1);d.exports.useEffect(()=>{k.listen("CREATE",r=>{t({type:"viewJoin",payload:{room:r}}),s.current=!1}),k.listen("VERIFY",r=>{s.current=!1,t(r?{type:"viewJoin",payload:{room:r}}:{type:"viewMain"})}),k.listen("RECONNECT",r=>{r||t({type:"viewMain"})})},[]);const e=r=>{if(!s.current)switch(r){case R.CREATE:s.current=!0,i.emit("CREATE");break;case R.JOIN:t({type:"viewCodeInput"});break;case R.PLAY:s.current=!0,i.emit("VERIFY",{room:n.room});break;default:console.log(r);return}},c=()=>{i.emit("LEAVE"),t({type:"viewMain"})},l=r=>{t({type:"setCodeInput",payload:r.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},f=r=>{var S;((S=r.key)==null?void 0:S.toUpperCase())==="ENTER"&&e(R.PLAY)},a=()=>{var r;return u("div",{className:"flex-col",children:[o("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:n.room||"",onChange:l,onKeyPress:f,spellCheck:"false",autoComplete:"false",autoFocus:!0}),o("button",{className:"flex play-btn "+(((r=n.room)==null?void 0:r.length)===5?"":"hidden"),onClick:()=>e(R.PLAY),children:o("img",{src:R.TRIANGLE_RIGHT})})]})},h=r=>{const g=r.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase();t({type:"setNameInput",payload:g}),i.name=g,i.setName(g)},b=()=>o("div",{className:"flex-col",children:o("input",{className:"input",type:"text",placeholder:"PLAYER NAME",value:n.name||"",onChange:h,spellCheck:"false",autoComplete:"false",autoFocus:!0})});return o("div",{className:"app",children:o(se,{children:(()=>{const r=n.view&&o("button",{className:"back-btn",onClick:c,children:" BACK "});switch(n.view){case"game":return o(ae,{room:n.room,children:r});case"codeInput":return u("div",{className:"main-screen flex-col flex-fill",children:[r,o("label",{className:"flex title-label",children:" XORDLE "}),a()]});default:return u("div",{className:"main-screen flex-col flex-fill",children:[r,o("label",{className:"flex title-label",children:" XORDLE "}),b(),o(ne,{options:R.MENU_OPTIONS,onClick:e})]})}})()})})},de=(n,t)=>{const{type:s,payload:e}=t;switch(s){case"viewMain":return y(E({},n),{view:null,room:null});case"viewJoin":return y(E({},n),{view:"game",room:e.room});case"viewCodeInput":return y(E({},n),{view:"codeInput"});case"setCodeInput":return y(E({},n),{room:e});case"setNameInput":return y(E({},n),{name:e});default:return E({},n)}},fe={view:R.VIEW,room:null,name:localStorage.getItem("xordle_name")};q.render(o(Z.StrictMode,{children:o(ue,{})}),document.getElementById("root"));
