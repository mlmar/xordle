var U=Object.defineProperty,j=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var _=(t,s,e)=>s in t?U(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,E=(t,s)=>{for(var e in s||(s={}))M.call(s,e)&&_(t,e,s[e]);if(L)for(var e of L(s))W.call(s,e)&&_(t,e,s[e]);return t},y=(t,s)=>j(t,J(s));import{j as w,r as p,R as Y,a as B}from"./vendor.8cd058a3.js";const V=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}};V();const o=w.exports.jsx,m=w.exports.jsxs,P=w.exports.Fragment,I={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},F={MENU_OPTIONS:[{id:I.CREATE,text:"CREATE"},{id:I.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:o(P,{children:"\xA0"})},g=E(E({},I),F),G="xordle.herokuapp.com",H="https://"+G,z="wss://"+G;let i=null;const S={},O=(t,s)=>t.split(" ").forEach(e=>S[e]=s),$=()=>{fetch(H+"/ping"),i.emit("PING")},K=()=>(i&&(console.warn("Client already iniitialized. Removing existing client..."),i.close()),O("PING PONG",()=>{console.log("Received server ping")}),O("SET_ID",t=>{i&&(i.id=t),console.log("Socket initialized")}),i=new WebSocket(z),i.emit=(t,s)=>{i?i.send(JSON.stringify({action:t,payload:s})):console.warn("No client found")},i.addEventListener("message",t=>{const{data:s}=t,{action:e,payload:l}=JSON.parse(s);S[e]&&S[e](l)}),i.addEventListener("close",t=>{console.warn("Client closed. Reconnecting..."),setTimeout(()=>{K()},1e3)}),setInterval($,g.PING_DELAY),i),R={init:K,listen:O},X=t=>{const{children:s,onDisconnect:e}=t;return p.exports.useEffect(()=>{try{R.init()}catch(l){e(l)}},[]),o(P,{children:s})},q=t=>{const{options:s,onClick:e,className:l}=t,n=()=>l?" "+l:"",r=c=>{const{id:d}=c.target;e&&d&&e(d)};return o("div",{className:"menu flex-col"+n(),onClick:r,children:s.map(({id:c,text:d})=>m("button",{id:c,children:[" ",d," "]},c))})};const A=t=>{switch(parseInt(t)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},Z=t=>t<33?"bg-red":t<66?"bg-yellow":"bg-green",Q=t=>/^[a-zA-Z]$/.test(t);const D=t=>{const{keys:s,onClick:e,disabled:l}=t,n=c=>{var d;l||(c.preventDefault(),c.target.id?e&&e({key:c.target.id}):(d=c.touches)==null||d.forEach(a=>{e&&e({key:a.id})}))},r=(c,d,a)=>{const b=g.KEYS["ROW_"+c];return m("div",{className:"flex keyboard-row",children:[d,b.map(f=>o(T,{letter:f,status:(s==null?void 0:s[f])>=0?s[f]:3,id:f},f)),a]})};return m("div",{className:"keyboard flex-col "+(l?"disabled":""),onTouchEnd:n,onClick:n,children:[r(0),r(1),r(2,o(T,{letter:"ENTER",status:3,id:"enter"}),o(T,{letter:o(P,{children:"\xAB"}),status:3,id:"backspace"}))]})},T=({letter:t,status:s,className:e,id:l})=>{let n=["flex keyboard-key",A(s),e||""].join(" ");return m("button",{className:n,id:l,children:[" ",t," "]})},ee=t=>{const{keys:s,history:e,inProgress:l,timeRemaining:n,keyboardDisabled:r,onKeyPress:c,current:d}=t,a=p.exports.useRef(null),b=p.exports.useRef(null);p.exports.useEffect(()=>{var u;(u=a==null?void 0:a.current)==null||u.focus()},[a]),p.exports.useEffect(()=>{b.current.scrollIntoView()},[d]);const f=u=>{if(!r)switch(u.key.toUpperCase()){case"ENTER":c&&c("ENTER");break;case"BACKSPACE":c&&c(null);break;default:Q(u.key)&&c&&c(u.key.toUpperCase());break}},h=()=>e==null?void 0:e.map((u,N)=>e.length-1===N?o("div",{className:"flex game-board-last",children:u==null?void 0:u.map((C,k)=>p.exports.createElement(v,y(E({},C),{key:C+k,delay:k*60})))},u+N):o("div",{className:"flex",children:u==null?void 0:u.map((C,k)=>p.exports.createElement(v,y(E({},C),{key:C+k})))},u+N)),x=()=>{const u=[];for(let N=0;N<5;N++)u.push(o(v,{letter:d[N],status:d[N]?4:5},(d[N]||"")+N));return u};return m("div",{className:"game-board flex-col flex-fill ",onKeyDown:f,tabIndex:"0",ref:a,children:[m("div",{className:"flex-col flex-fill overflow game-board-list",children:[h(),o("div",{className:"flex game-board-current",ref:b,children:l&&x()},e==null?void 0:e.length)]}),o(te,{className:"game-board-progress",progress:n}),o(D,{keys:s,disabled:r,onClick:f})]})},te=({className:t,progress:s})=>{const e=s*100,l=[t||"","flex progress"].join(" "),n=["flex progress-bar",Z(e)].join(" "),r={width:e+"%"};return o("div",{className:l,children:o("div",{className:n,style:r})})},v=({letter:t,status:s,delay:e})=>{const[l,n]=p.exports.useState("bg-placeholder");p.exports.useEffect(()=>{e&&setTimeout(()=>{n(A(s))},e)},[s,e]);const r=["flex game-board-letter",e?l:A(s)].join(" ");return o("div",{className:"game-board-letter-wrapper",children:m("span",{className:r,children:[" ",t||g.BLANK," "]})})},se=t=>{const{room:s}=t,[e,l]=p.exports.useState(null),[n,r]=p.exports.useState([]),c=()=>(e==null?void 0:e.host)===i.id;p.exports.useEffect(()=>{i.room=s,i.emit("JOIN",{room:s}),R.listen("JOIN",l),R.listen("UPDATE",f=>{l(h=>((h==null?void 0:h.turn)!==(f==null?void 0:f.turn)&&r([]),f))})},[]);const d=()=>{c()&&i.emit("START")},a=()=>{c()&&i.emit("END")},b=f=>{f==="ENTER"?n.length===5?i.emit("ENTER_WORD"):r([]):r(f?h=>{const x=h.length<5?[...h,f]:h;return i.emit("SET_CURRENT",{current:x}),x}:h=>{if(h.length===0)return[];const x=[...h];return x.pop(),i.emit("SET_CURRENT",{current:x}),x})};return m("div",{className:"flex-col flex-fill game",children:[(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&m("div",{className:"flex-col flex-fill game-end",children:[o("label",{className:"game-end-label",children:" Word: "}),m("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),o("button",{className:c()?"":"hidden",onClick:a,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&o(ee,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:n,onKeyPress:b,inProgress:e==null?void 0:e.turn,timeRemaining:e==null?void 0:e.timeRemaining,keyboardDisabled:(e==null?void 0:e.turn)!==(i==null?void 0:i.id)}),!(e!=null&&e.inProgress)&&m("div",{className:"flex-col flex-fill game-lobby",children:[m("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),m("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),o("button",{className:"start-btn",onClick:d,children:c()?"START":"WAITING FOR HOST"})]})]})},ne=()=>{const[t,s]=p.exports.useReducer(re,oe),e=p.exports.useRef(!1);p.exports.useEffect(()=>{R.listen("CREATE",a=>{s({type:"viewJoin",payload:{room:a}}),e.current=!1}),R.listen("VERIFY",a=>{e.current=!1,a&&s({type:"viewJoin",payload:{room:a}})})},[]);const l=a=>{if(!e.current)switch(a){case g.CREATE:e.current=!0,i.emit("CREATE");break;case g.JOIN:s({type:"viewCodeInput"});break;case g.PLAY:e.current=!0,i.emit("VERIFY",{room:t.room});break;default:console.log(a);return}},n=a=>{s({type:"setCodeInput",payload:a.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},r=()=>{var a;return m("div",{className:"flex-col",children:[o("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:t.room||"",onChange:n,spellCheck:"false",autoComplete:"false",autoFocus:!0}),o("button",{className:"flex play-btn "+(((a=t.room)==null?void 0:a.length)===5?"":"hidden"),onClick:()=>l(g.PLAY),children:o("img",{src:g.TRIANGLE_RIGHT})})]})};return o("div",{className:"app",children:o(X,{onDisconnect:()=>{s({type:"viewMain"})},children:(()=>{switch(t.view){case"game":return o(se,{room:t.room});default:return m("div",{className:"main-screen flex-col flex-fill",children:[o("label",{className:"flex title-label",children:" XORDLE "}),t.view!=="codeInput"?o(q,{options:g.MENU_OPTIONS,onClick:l}):r()]})}})()})})},re=(t,s)=>{const{type:e,payload:l}=s;switch(e){case"viewMain":return y(E({},t),{view:null});case"viewJoin":return y(E({},t),{view:"game",room:l.room});case"viewCodeInput":return y(E({},t),{view:"codeInput"});case"setCodeInput":return y(E({},t),{room:l});default:return E({},t)}},oe={view:g.VIEW,room:null};Y.render(o(B.StrictMode,{children:o(ne,{})}),document.getElementById("root"));
