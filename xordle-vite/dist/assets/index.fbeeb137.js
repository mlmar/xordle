var B=Object.defineProperty,J=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var Y=(r,t,s)=>t in r?B(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,E=(r,t)=>{for(var s in t||(t={}))F.call(t,s)&&Y(r,s,t[s]);if(G)for(var s of G(t))V.call(t,s)&&Y(r,s,t[s]);return r},R=(r,t)=>J(r,W(t));import{j as U,r as m,R as z,a as H}from"./vendor.8cd058a3.js";const $=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))e(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&e(u)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerpolicy&&(n.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?n.credentials="include":l.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}};$();const c=U.exports.jsx,f=U.exports.jsxs,_=U.exports.Fragment,P={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},X={MENU_OPTIONS:[{id:P.CREATE,text:"CREATE"},{id:P.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:c(_,{children:"\xA0"})},b=E(E({},P),X),q="xordle.herokuapp.com",Z="wss://"+q;let i=null,A=null,O=null;const L={},K=(r,t)=>r.split(" ").forEach(s=>L[s]=t),j=()=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(O),O=null);const r=()=>{i.emit("PING")};return K("PING",()=>{console.log("Received server ping")}),K("SET_ID",t=>{!i||(i.id=t,A&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:A})),A=t,console.log("Socket initialized"))}),i=new WebSocket(Z),i.emit=(t,s)=>{i?i.send(JSON.stringify({action:t,payload:s})):console.warn("No client found")},i.addEventListener("message",t=>{const{data:s}=t,{action:e,payload:l}=JSON.parse(s);L[e]&&L[e](l)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),j()}),O=setInterval(r,b.PING_DELAY),i},v={init:j,listen:K},Q=r=>{const{children:t}=r;return m.exports.useEffect(()=>{v.init()},[]),c(_,{children:t})},D=r=>{const{options:t,onClick:s,className:e}=r,l=()=>e?" "+e:"",n=u=>{const{id:a}=u.target;s&&a&&s(a)};return c("div",{className:"menu flex-col"+l(),onClick:n,children:t.map(({id:u,text:a})=>f("button",{id:u,children:[" ",a," "]},u))})};const M=r=>{switch(parseInt(r)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},ee=r=>r<33?"bg-red":r<66?"bg-yellow":"bg-green",te=r=>/^[a-zA-Z]$/.test(r);const se=r=>{const{keys:t,onClick:s,disabled:e}=r,l=a=>{var h,g;if(!e)if((h=a.touches)!=null&&h.length){let o=[];for(let d of a.touches)d&&o.push(d);o=o[o.length-1],((g=o==null?void 0:o.target)==null?void 0:g.id)&&s&&s({key:o.target.id})}else a.target.id&&s&&s({key:a.target.id})},n=(a,h,g)=>{const o=b.KEYS["ROW_"+a];return f("div",{className:"flex keyboard-row",children:[h,o.map(d=>c(S,{letter:d,status:(t==null?void 0:t[d])>=0?t[d]:3,id:d},d)),g]})},u=a=>a.preventDefault();return f("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:u,onTouchStart:l,onMouseUp:l,children:[n(0),n(1),n(2,c(S,{letter:"ENTER",status:3,id:"enter"}),c(S,{letter:c(_,{children:"\xAB"}),status:3,id:"backspace"}))]})},S=({letter:r,status:t,className:s,id:e})=>{let l=["flex keyboard-key",M(t),s||""].join(" ");return c("span",{className:"flex keyboard-key-container",id:e,children:f("button",{className:l,id:e,children:[" ",r," "]})})},ne=r=>{const{keys:t,history:s,inProgress:e,timeRemaining:l,keyboardDisabled:n,onKeyPress:u,current:a,room:h,name:g,message:o}=r,d=m.exports.useRef(null),I=m.exports.useRef(null);m.exports.useEffect(()=>{var p;(p=d==null?void 0:d.current)==null||p.focus()},[d]),m.exports.useEffect(()=>{I.current.scrollIntoView()},[a]);const C=p=>{if(!n)switch(p.key.toUpperCase()){case"ENTER":u&&u("ENTER");break;case"BACKSPACE":u&&u(null);break;default:te(p.key)&&u&&u(p.key.toUpperCase());break}},N=()=>s==null?void 0:s.map((p,x)=>s.length-1===x?c("div",{className:"flex game-board-last",children:p==null?void 0:p.map((k,T)=>m.exports.createElement(w,R(E({},k),{key:k+T,delay:T*60})))},p+x):c("div",{className:"flex",children:p==null?void 0:p.map((k,T)=>m.exports.createElement(w,R(E({},k),{key:k+T})))},p+x)),y=()=>{const p=[];for(let x=0;x<5;x++)p.push(c(w,{letter:a[x],status:a[x]?4:5},(a[x]||"")+x));return p};return f("div",{className:"game-board flex-col flex-fill ",onKeyDown:C,tabIndex:"0",ref:d,children:[f("label",{className:"floating-purple-text float-left",children:[" ",o," "]}),f("label",{className:"floating-purple-text float-right",children:[" ",h," "]}),f("div",{className:"flex-col flex-fill overflow game-board-list",children:[N(),c("div",{className:"flex game-board-current",ref:I,children:e&&y()},s==null?void 0:s.length)]}),c(re,{className:"game-board-progress",progress:l}),c(se,{keys:t,disabled:n,onClick:C})]})},re=({className:r,progress:t})=>{const s=t*100,e=[r||"","flex progress"].join(" "),l=["flex progress-bar",ee(s)].join(" "),n={width:s+"%"};return c("div",{className:e,children:c("div",{className:l,style:n})})},w=({letter:r,status:t,delay:s})=>{const[e,l]=m.exports.useState("bg-placeholder active"),n=m.exports.useRef(null);m.exports.useEffect(()=>{if(s)return n.current=setTimeout(()=>{l(M(t))},s),()=>clearTimeout(n.current)},[t,s]);const u=["flex game-board-letter",s?e:M(t)].join(" ");return c("div",{className:"game-board-letter-wrapper",children:f("span",{className:u,children:[" ",r||b.BLANK," "]})})},le=r=>{const{room:t,children:s}=r,[e,l]=m.exports.useState(null),[n,u]=m.exports.useState(null),[a,h]=m.exports.useState([]),g=()=>(e==null?void 0:e.host)===i.id;m.exports.useEffect(()=>{i.room=t,i.emit("JOIN",{room:t}),v.listen("JOIN",l),v.listen("UPDATE",l),v.listen("PLAYER_UPDATE",u)},[]),m.exports.useEffect(()=>{((n==null?void 0:n.correct)===!1||(n==null?void 0:n.correct)===!0)&&h([])},[n]);const o=()=>{g()&&i.emit("START")},d=()=>{g()&&i.emit("END")},I=C=>{C==="ENTER"?(a.length===5&&i.emit("ENTER_WORD",{current:a}),h([])):h(C?N=>N.length<5?[...N,C]:N:N=>{if(N.length===0)return[];const y=[...N];return y.pop(),y})};return f("div",{className:"flex-col flex-fill game",children:[!(e!=null&&e.status)>0&&s,(e==null?void 0:e.status)===2&&f("div",{className:"flex-col flex-fill game-end",children:[f("label",{className:"game-end-word underline",children:[" ",e==null?void 0:e.word," "]}),e==null?void 0:e.winOrder.map((C,N)=>N<4?f("label",{className:"game-end-word",children:[" #",N+1," - ",C," "]},N+C):null),c("button",{className:g()?"":"hidden",onClick:d,children:" RESTART "})]}),(e==null?void 0:e.status)>0&&c(ne,{keys:n==null?void 0:n.keys,history:n==null?void 0:n.history,current:a,onKeyPress:I,inProgress:n==null?void 0:n.inProgress,timeRemaining:n==null?void 0:n.timeRemaining,keyboardDisabled:!(n!=null&&n.inProgress),name:(n==null?void 0:n.name)||i.name,room:t,message:e==null?void 0:e.message}),(e==null?void 0:e.status)===0&&f("div",{className:"flex-col flex-fill game-lobby",children:[f("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),f("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),c("button",{className:"start-btn",onClick:o,children:g()?"START":"WAITING FOR HOST"})]})]})},oe=()=>{const[r,t]=m.exports.useReducer(ce,ie),s=m.exports.useRef(!1);m.exports.useEffect(()=>{v.listen("CREATE",o=>{t({type:"viewJoin",payload:{room:o}}),s.current=!1}),v.listen("VERIFY",o=>{s.current=!1,o&&t({type:"viewJoin",payload:{room:o}})}),v.listen("RECONNECT",o=>{o||t({type:"viewMain"})})},[]);const e=o=>{if(!s.current)switch(o){case b.CREATE:s.current=!0,i.emit("CREATE");break;case b.JOIN:t({type:"viewCodeInput"});break;case b.PLAY:s.current=!0,i.emit("VERIFY",{room:r.room});break;default:console.log(o);return}},l=()=>{i.emit("LEAVE"),t({type:"viewMain"})},n=o=>{t({type:"setCodeInput",payload:o.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},u=()=>{var o;return f("div",{className:"flex-col",children:[c("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:r.room||"",onChange:n,spellCheck:"false",autoComplete:"false",autoFocus:!0}),c("button",{className:"flex play-btn "+(((o=r.room)==null?void 0:o.length)===5?"":"hidden"),onClick:()=>e(b.PLAY),children:c("img",{src:b.TRIANGLE_RIGHT})})]})},a=o=>{const d=o.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase();t({type:"setNameInput",payload:d}),i.name=d,i.emit("NAME",{name:d})},h=()=>c("div",{className:"flex-col",children:c("input",{className:"input",type:"text",placeholder:"PLAYER NAME",value:r.name||"",onChange:a,spellCheck:"false",autoComplete:"false",autoFocus:!0})});return c("div",{className:"app",children:c(Q,{children:(()=>{const o=r.view&&c("button",{className:"back-btn",onClick:l,children:" BACK "});switch(r.view){case"game":return c(le,{room:r.room,children:o});case"codeInput":return f("div",{className:"main-screen flex-col flex-fill",children:[o,c("label",{className:"flex title-label",children:" XORDLE "}),u()]});default:return f("div",{className:"main-screen flex-col flex-fill",children:[o,c("label",{className:"flex title-label",children:" XORDLE "}),h(),c(D,{options:b.MENU_OPTIONS,onClick:e})]})}})()})})},ce=(r,t)=>{const{type:s,payload:e}=t;switch(s){case"viewMain":return R(E({},r),{view:null,room:null});case"viewJoin":return R(E({},r),{view:"game",room:e.room});case"viewCodeInput":return R(E({},r),{view:"codeInput"});case"setCodeInput":return R(E({},r),{room:e});case"setNameInput":return R(E({},r),{name:e});default:return E({},r)}},ie={view:b.VIEW,room:null};z.render(c(H.StrictMode,{children:c(oe,{})}),document.getElementById("root"));
