var F=Object.defineProperty,V=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var J=(n,t,s)=>t in n?F(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s,E=(n,t)=>{for(var s in t||(t={}))H.call(t,s)&&J(n,s,t[s]);if(Y)for(var s of Y(t))$.call(t,s)&&J(n,s,t[s]);return n},R=(n,t)=>V(n,z(t));import{j as B,r as h,R as X,a as q}from"./vendor.2d6b8063.js";const Z=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&e(f)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function e(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}};Z();const r=B.exports.jsx,u=B.exports.jsxs,w=B.exports.Fragment,G={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},Q={MENU_OPTIONS:[{id:G.CREATE,text:"CREATE"},{id:G.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:r(w,{children:"\xA0"})},C=E(E({},G),Q),D="xordle.herokuapp.com",ee="wss://"+D;let i=null,L=null;const K={},M=(n,t)=>n.split(" ").forEach(s=>K[s]=e=>{t(e)}),W=()=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(L),L=null);const n=()=>{i.emit("PING")};return M("PING",()=>{console.log("Received server ping")}),M("SET_ID",t=>{if(!i)return;i.id=t;let s=localStorage.getItem("xordle_id");s&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:s}));let e=localStorage.getItem("xordle_name");e&&i.setName(e),localStorage.setItem("xordle_id",t),console.log("Socket initialized")}),i=new WebSocket(ee),i.emit=(t,s)=>{i?i.send(JSON.stringify({action:t,payload:s})):console.warn("No client found")},i.setName=t=>{localStorage.setItem("xordle_name",t),i.emit("SET_NAME",{name:t})},i.addEventListener("message",t=>{const{data:s}=t,{action:e,payload:o}=JSON.parse(s);K[e]&&K[e](o)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),W()}),L=setInterval(n,C.PING_DELAY),i},S={init:W,listen:M},te=n=>{const{children:t}=n;return h.exports.useEffect(()=>{S.init()},[]),r(w,{children:t})},se=n=>{const{options:t,onClick:s,className:e}=n,o=()=>e?" "+e:"",l=f=>{const{id:a}=f.target;s&&a&&s(a)};return r("div",{className:"menu flex-col"+o(),onClick:l,children:t.map(({id:f,text:a})=>u("button",{id:f,children:[" ",a," "]},f))})};const j=n=>{switch(parseInt(n)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},ne=n=>n<33?"bg-red":n<66?"bg-yellow":"bg-green",le=n=>/^[a-zA-Z]$/.test(n);const re=n=>{const{keys:t,onClick:s,disabled:e}=n,o=a=>{var g,b;if(!e)if((g=a.touches)!=null&&g.length){let c=[];for(let d of a.touches)d&&c.push(d);c=c[c.length-1],((b=c==null?void 0:c.target)==null?void 0:b.id)&&s&&s({key:c.target.id})}else a.target.id&&s&&s({key:a.target.id})},l=(a,g,b)=>{const c=C.KEYS["ROW_"+a];return u("div",{className:"flex keyboard-row",children:[g,c.map(d=>r(_,{letter:d,status:(t==null?void 0:t[d])>=0?t[d]:3,id:d},d)),b]})},f=a=>a.preventDefault();return u("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:f,onTouchStart:o,onMouseUp:o,children:[l(0),l(1),l(2,r(_,{letter:"ENTER",status:3,id:"enter"}),r(_,{letter:r(w,{children:"\xAB"}),status:3,id:"backspace"}))]})},_=({letter:n,status:t,className:s,id:e})=>{let o=["flex keyboard-key",j(t),s||""].join(" ");return r("span",{className:"flex keyboard-key-container",id:e,children:u("button",{className:o,id:e,children:[" ",n," "]})})},oe=n=>{const{keys:t,history:s,inProgress:e,timeRemaining:o,showTimeRemaining:l,keyboardDisabled:f,onKeyPress:a,current:g,room:b,name:c,message:d}=n,k=h.exports.useRef(null),T=h.exports.useRef(null);h.exports.useEffect(()=>{var m;(m=k==null?void 0:k.current)==null||m.focus()},[k]),h.exports.useEffect(()=>{T.current.scrollIntoView()},[g]);const I=m=>{if(!f)switch(m.key.toUpperCase()){case"ENTER":a&&a("ENTER");break;case"BACKSPACE":a&&a(null);break;default:le(m.key)&&a&&a(m.key.toUpperCase());break}},A=()=>s==null?void 0:s.map((m,N)=>s.length-1===N?r("div",{className:"flex game-board-last",children:m==null?void 0:m.map((y,v)=>h.exports.createElement(U,R(E({},y),{key:y+v,delay:v*60})))},m+N):r("div",{className:"flex",children:m==null?void 0:m.map((y,v)=>h.exports.createElement(U,R(E({},y),{key:y+v})))},m+N)),O=()=>{const m=[];for(let N=0;N<5;N++)m.push(r(U,{letter:g[N],status:g[N]?4:5},(g[N]||"")+N));return m};return u("div",{className:"game-board flex-col flex-fill ",onKeyDown:I,tabIndex:"0",ref:k,children:[u("label",{className:"floating-purple-text float-left",children:[" ",d," "]}),u("label",{className:"floating-purple-text float-right",children:[" ",b," "]}),u("div",{className:"flex-col flex-fill overflow game-board-list",children:[A(),r("div",{className:"flex game-board-current",ref:T,children:e&&O()},s==null?void 0:s.length)]}),l&&r(ce,{className:"game-board-progress",progress:o}),r(re,{keys:t,disabled:f,onClick:I})]})},ce=({className:n,progress:t})=>{const s=t*100,e=[n||"","flex progress"].join(" "),o=["flex progress-bar",ne(s)].join(" "),l={width:s+"%"};return r("div",{className:e,children:r("div",{className:o,style:l})})},U=({letter:n,status:t,delay:s})=>{const[e,o]=h.exports.useState("bg-placeholder active"),l=h.exports.useRef(null);h.exports.useEffect(()=>{if(s)return l.current=setTimeout(()=>{o(j(t))},s),()=>clearTimeout(l.current)},[t,s]);const f=["flex game-board-letter",s?e:j(t)].join(" ");return r("div",{className:"game-board-letter-wrapper",children:u("span",{className:f,children:[" ",n||C.BLANK," "]})})},ie=n=>{const{room:t,children:s}=n,[e,o]=h.exports.useState(null),[l,f]=h.exports.useState(null),[a,g]=h.exports.useState([]),[b,c]=h.exports.useState(!1),[d,k]=h.exports.useState(null),T=()=>(e==null?void 0:e.host)===i.id,I=p=>{o(p.room),f(p.player)};h.exports.useEffect(()=>{i.room=t,i.emit("JOIN",{room:t}),S.listen("JOIN",o),S.listen("UPDATE",o),S.listen("PLAYER_UPDATE",f),S.listen("SERVER_UPDATE",I),S.listen("SETTINGS_UPDATE",k)},[]),h.exports.useEffect(()=>{((l==null?void 0:l.correct)===!1||(l==null?void 0:l.correct)===!0)&&g([])},[l]);const A=()=>{c(p=>!p)},O=p=>{const x=R(E({},d),{[p.target.id]:p.target.checked});i.emit("SETTINGS_UPDATE",{settings:x})},m=()=>u("div",{className:"flex flex-col flex-fill settings-panel",children:[r("button",{className:"back-btn",onClick:A,children:" BACK "}),d&&Object.keys(d).map(p=>u("div",{className:"flex flex-middle",children:[r("input",{type:"checkbox",className:"flex",checked:d[p],id:p,onChange:O}),u("label",{className:"flex flex-middle",htmlFor:p,children:[" ",p," "]})]},p))]}),N=()=>{T()&&i.emit("START")},y=()=>{T()&&i.emit("END")},v=p=>{p==="ENTER"?(a.length===5&&i.emit("ENTER_WORD",{current:a}),g([])):g(p?x=>x.length<5?[...x,p]:x:x=>{if(x.length===0)return[];const P=[...x];return P.pop(),P})};return u("div",{className:"flex-col flex-fill game",children:[!(e!=null&&e.status)>0&&!b&&s,(e==null?void 0:e.status)===2&&u("div",{className:"flex-col flex-fill game-end",children:[u("label",{className:"game-end-word underline",children:[" ",e==null?void 0:e.word," "]}),e==null?void 0:e.winOrder.map(({name:p},x)=>x<4?u("label",{className:"game-end-word",children:[" #",x+1," - ",p," "]},x+p):null),r("button",{className:T()?"":"hidden",onClick:y,children:" RESTART "})]}),(e==null?void 0:e.status)>0&&r(oe,{keys:l==null?void 0:l.keys,history:l==null?void 0:l.history,current:a,onKeyPress:v,inProgress:l==null?void 0:l.inProgress,timeRemaining:l==null?void 0:l.timeRemaining,showTimeRemaining:d==null?void 0:d["GUESS TIMER"],keyboardDisabled:!(l!=null&&l.inProgress),name:(l==null?void 0:l.name)||i.name,room:t,message:"["+(e==null?void 0:e.timeRemaining)+"] "+(e==null?void 0:e.message)}),(e==null?void 0:e.status)===0&&u("div",{className:"flex-col flex-fill game-lobby",children:[r("button",{className:"flex floating-purple-text float-right",onClick:A,children:" SETTINGS "}),u("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),b?m():u(w,{children:[u("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),r("button",{className:"start-btn",onClick:N,children:T()?"START":"WAITING FOR HOST"})]})]})]})},ae=()=>{const[n,t]=h.exports.useReducer(ue,de),s=h.exports.useRef(!1);h.exports.useEffect(()=>{S.listen("CREATE",c=>{t({type:"viewJoin",payload:{room:c}}),s.current=!1}),S.listen("VERIFY",c=>{s.current=!1,c&&t({type:"viewJoin",payload:{room:c}})}),S.listen("RECONNECT",c=>{c||t({type:"viewMain"})})},[]);const e=c=>{if(!s.current)switch(c){case C.CREATE:s.current=!0,i.emit("CREATE");break;case C.JOIN:t({type:"viewCodeInput"});break;case C.PLAY:s.current=!0,i.emit("VERIFY",{room:n.room});break;default:console.log(c);return}},o=()=>{i.emit("LEAVE"),t({type:"viewMain"})},l=c=>{t({type:"setCodeInput",payload:c.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},f=()=>{var c;return u("div",{className:"flex-col",children:[r("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:n.room||"",onChange:l,spellCheck:"false",autoComplete:"false",autoFocus:!0}),r("button",{className:"flex play-btn "+(((c=n.room)==null?void 0:c.length)===5?"":"hidden"),onClick:()=>e(C.PLAY),children:r("img",{src:C.TRIANGLE_RIGHT})})]})},a=c=>{const d=c.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase();t({type:"setNameInput",payload:d}),i.name=d,i.setName(d)},g=()=>r("div",{className:"flex-col",children:r("input",{className:"input",type:"text",placeholder:"PLAYER NAME",value:n.name||"",onChange:a,spellCheck:"false",autoComplete:"false",autoFocus:!0})});return r("div",{className:"app",children:r(te,{children:(()=>{const c=n.view&&r("button",{className:"back-btn",onClick:o,children:" BACK "});switch(n.view){case"game":return r(ie,{room:n.room,children:c});case"codeInput":return u("div",{className:"main-screen flex-col flex-fill",children:[c,r("label",{className:"flex title-label",children:" XORDLE "}),f()]});default:return u("div",{className:"main-screen flex-col flex-fill",children:[c,r("label",{className:"flex title-label",children:" XORDLE "}),g(),r(se,{options:C.MENU_OPTIONS,onClick:e})]})}})()})})},ue=(n,t)=>{const{type:s,payload:e}=t;switch(s){case"viewMain":return R(E({},n),{view:null,room:null});case"viewJoin":return R(E({},n),{view:"game",room:e.room});case"viewCodeInput":return R(E({},n),{view:"codeInput"});case"setCodeInput":return R(E({},n),{room:e});case"setNameInput":return R(E({},n),{name:e});default:return E({},n)}},de={view:C.VIEW,room:null,name:localStorage.getItem("xordle_name")};X.render(r(q.StrictMode,{children:r(ae,{})}),document.getElementById("root"));
