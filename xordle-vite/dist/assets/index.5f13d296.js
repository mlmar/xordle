var U=Object.defineProperty,j=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var _=(s,r,e)=>r in s?U(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e,N=(s,r)=>{for(var e in r||(r={}))M.call(r,e)&&_(s,e,r[e]);if(L)for(var e of L(r))W.call(r,e)&&_(s,e,r[e]);return s},y=(s,r)=>j(s,J(r));import{j as w,r as p,R as Y,a as B}from"./vendor.8cd058a3.js";const V=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function e(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(t){if(t.ep)return;t.ep=!0;const n=e(t);fetch(t.href,n)}};V();const l=w.exports.jsx,m=w.exports.jsxs,P=w.exports.Fragment,I={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},F={MENU_OPTIONS:[{id:I.CREATE,text:"CREATE"},{id:I.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:l(P,{children:"\xA0"})},E=N(N({},I),F),G="xordle.herokuapp.com",H="https://"+G,z="wss://"+G;let o=null;const S={},O=(s,r)=>s.split(" ").forEach(e=>S[e]=r),$=()=>{fetch(H+"/ping"),o.emit("PING")},K=()=>(o==null||o.id,o==null||o.room,o&&(console.warn("Client already iniitialized. Removing existing client..."),o.close()),O("PING PONG",()=>{console.log("Received server ping")}),O("SET_ID",s=>{o&&(o.id=s),console.log("Socket initialized")}),o=new WebSocket(z),o.emit=(s,r)=>{o?o.send(JSON.stringify({action:s,payload:r})):console.warn("No client found")},o.addEventListener("message",s=>{const{data:r}=s,{action:e,payload:c}=JSON.parse(r);S[e]&&S[e](c)}),o.addEventListener("close",s=>{console.warn("Client closed. Reconnecting..."),setTimeout(()=>{K()},1e3)}),setInterval($,E.PING_DELAY),o),R={init:K,listen:O},X=s=>{const{children:r,onDisconnect:e}=s;return p.exports.useEffect(()=>{try{R.init()}catch(c){e(c)}},[]),l(P,{children:r})},q=s=>{const{options:r,onClick:e,className:c}=s,t=()=>c?" "+c:"",n=u=>{const{id:f}=u.target;e&&f&&e(f)};return l("div",{className:"menu flex-col"+t(),onClick:n,children:r.map(({id:u,text:f})=>m("button",{id:u,children:[" ",f," "]},u))})};const A=s=>{switch(parseInt(s)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},Z=s=>s<33?"bg-red":s<66?"bg-yellow":"bg-green",Q=s=>/^[a-zA-Z]$/.test(s);const D=s=>{const{keys:r,onClick:e,disabled:c}=s,t=u=>{var f;c||(u.preventDefault(),u.target.id?e&&e({key:u.target.id}):(f=u.touches)==null||f.forEach(a=>{e&&e({key:a.id})}))},n=(u,f,a)=>{const b=E.KEYS["ROW_"+u];return m("div",{className:"flex keyboard-row",children:[f,b.map(i=>l(v,{letter:i,status:(r==null?void 0:r[i])>=0?r[i]:3,id:i},i)),a]})};return m("div",{className:"keyboard flex-col "+(c?"disabled":""),onTouchEnd:t,onClick:t,children:[n(0),n(1),n(2,l(v,{letter:"ENTER",status:3,id:"enter"}),l(v,{letter:l(P,{children:"\xAB"}),status:3,id:"backspace"}))]})},v=({letter:s,status:r,className:e,id:c})=>{let t=["flex keyboard-key",A(r),e||""].join(" ");return m("button",{className:t,id:c,children:[" ",s," "]})},ee=s=>{const{keys:r,history:e,inProgress:c,timeRemaining:t,keyboardDisabled:n,onKeyPress:u,current:f}=s,a=p.exports.useRef(null),b=p.exports.useRef(null);p.exports.useEffect(()=>{var d;(d=a==null?void 0:a.current)==null||d.focus()},[a]),p.exports.useEffect(()=>{b.current.scrollIntoView()},[f]);const i=d=>{if(!n)switch(d.key.toUpperCase()){case"ENTER":u&&u("ENTER");break;case"BACKSPACE":u&&u(null);break;default:Q(d.key)&&u&&u(d.key.toUpperCase());break}},g=()=>e==null?void 0:e.map((d,h)=>e.length-1===h?l("div",{className:"flex game-board-last",children:d==null?void 0:d.map((C,k)=>p.exports.createElement(T,y(N({},C),{key:C+k,delay:k*60})))},d+h):l("div",{className:"flex",children:d==null?void 0:d.map((C,k)=>p.exports.createElement(T,y(N({},C),{key:C+k})))},d+h)),x=()=>{const d=[];for(let h=0;h<5;h++)d.push(l(T,{letter:f[h],status:f[h]?4:5},(f[h]||"")+h));return d};return m("div",{className:"game-board flex-col flex-fill ",onKeyDown:i,tabIndex:"0",ref:a,children:[m("div",{className:"flex-col flex-fill overflow game-board-list",children:[g(),l("div",{className:"flex game-board-current",ref:b,children:c&&x()},e==null?void 0:e.length)]}),l(se,{className:"game-board-progress",progress:t}),l(D,{keys:r,disabled:n,onClick:i})]})},se=({className:s,progress:r})=>{const e=r*100,c=[s||"","flex progress"].join(" "),t=["flex progress-bar",Z(e)].join(" "),n={width:e+"%"};return l("div",{className:c,children:l("div",{className:t,style:n})})},T=({letter:s,status:r,delay:e})=>{const[c,t]=p.exports.useState("bg-placeholder");p.exports.useEffect(()=>{e&&setTimeout(()=>{t(A(r))},e)},[r,e]);const n=["flex game-board-letter",e?c:A(r)].join(" ");return l("div",{className:"game-board-letter-wrapper",children:m("span",{className:n,children:[" ",s||E.BLANK," "]})})},re=s=>{const{room:r}=s,[e,c]=p.exports.useState(null),[t,n]=p.exports.useState([]),u=()=>(e==null?void 0:e.host)===o.id;p.exports.useEffect(()=>{o.room=r,o.emit("JOIN",{room:r}),R.listen("JOIN",c),R.listen("UPDATE",i=>{c(g=>(console.log(i==null?void 0:i.status),(i==null?void 0:i.status)===1?n([]):(i==null?void 0:i.status)===0&&(i==null?void 0:i.turn)!==o.id&&n(i==null?void 0:i.current),i))})},[]);const f=()=>{u()&&o.emit("START")},a=()=>{u()&&o.emit("END")},b=i=>{i==="ENTER"?t.length===5?o.emit("ENTER_WORD"):n([]):n(i?g=>{const x=g.length<5?[...g,i]:g;return o.emit("SET_CURRENT",{current:x}),x}:g=>{if(g.length===0)return[];const x=[...g];return x.pop(),o.emit("SET_CURRENT",{current:x}),x})};return m("div",{className:"flex-col flex-fill game",children:[(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&m("div",{className:"flex-col flex-fill game-end",children:[l("label",{className:"game-end-label",children:" Word: "}),m("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),l("button",{className:u()?"":"hidden",onClick:a,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&l(ee,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:t,onKeyPress:b,inProgress:e==null?void 0:e.turn,timeRemaining:e==null?void 0:e.timeRemaining,keyboardDisabled:(e==null?void 0:e.turn)!==(o==null?void 0:o.id)}),!(e!=null&&e.inProgress)&&m("div",{className:"flex-col flex-fill game-lobby",children:[m("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),m("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),l("button",{className:"start-btn",onClick:f,children:u()?"START":"WAITING FOR HOST"})]})]})},te=()=>{const[s,r]=p.exports.useReducer(ne,oe),e=p.exports.useRef(!1);p.exports.useEffect(()=>{R.listen("CREATE",a=>{r({type:"viewJoin",payload:{room:a}}),e.current=!1}),R.listen("VERIFY",a=>{e.current=!1,a&&r({type:"viewJoin",payload:{room:a}})})},[]);const c=a=>{if(!e.current)switch(a){case E.CREATE:e.current=!0,o.emit("CREATE");break;case E.JOIN:r({type:"viewCodeInput"});break;case E.PLAY:e.current=!0,o.emit("VERIFY",{room:s.room});break;default:console.log(a);return}},t=a=>{r({type:"setCodeInput",payload:a.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},n=()=>{var a;return m("div",{className:"flex-col",children:[l("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:s.room||"",onChange:t,spellCheck:"false",autoComplete:"false",autoFocus:!0}),l("button",{className:"flex play-btn "+(((a=s.room)==null?void 0:a.length)===5?"":"hidden"),onClick:()=>c(E.PLAY),children:l("img",{src:E.TRIANGLE_RIGHT})})]})};return l("div",{className:"app",children:l(X,{onDisconnect:()=>{r({type:"viewMain"})},children:(()=>{switch(s.view){case"game":return l(re,{room:s.room});default:return m("div",{className:"main-screen flex-col flex-fill",children:[l("label",{className:"flex title-label",children:" XORDLE "}),s.view!=="codeInput"?l(q,{options:E.MENU_OPTIONS,onClick:c}):n()]})}})()})})},ne=(s,r)=>{const{type:e,payload:c}=r;switch(e){case"viewMain":return y(N({},s),{view:null});case"viewJoin":return y(N({},s),{view:"game",room:c.room});case"viewCodeInput":return y(N({},s),{view:"codeInput"});case"setCodeInput":return y(N({},s),{room:c});default:return N({},s)}},oe={view:E.VIEW,room:null};Y.render(l(B.StrictMode,{children:l(te,{})}),document.getElementById("root"));
