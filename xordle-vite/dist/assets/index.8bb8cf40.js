var P=Object.defineProperty,_=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var O=(t,r,s)=>r in t?P(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,y=(t,r)=>{for(var s in r||(r={}))U.call(r,s)&&O(t,s,r[s]);if(S)for(var s of S(r))j.call(r,s)&&O(t,s,r[s]);return t},x=(t,r)=>_(t,K(r));import{j as k,r as p,R as G,a as J}from"./vendor.2d6b8063.js";const W=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerpolicy&&(l.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?l.credentials="include":n.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function e(n){if(n.ep)return;n.ep=!0;const l=s(n);fetch(n.href,l)}};W();const c=k.exports.jsx,f=k.exports.jsxs,I=k.exports.Fragment,C={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},Y={MENU_OPTIONS:[{id:C.CREATE,text:"CREATE"},{id:C.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",DICTIONARY_URL:"https://www.dictionary.com/browse/",BLANK:c(I,{children:"\xA0"})},h=y(y({},C),Y),M="xordle.onrender.com",B="wss://"+M;let d=null;const T={},v=(t,r)=>T[t]=r,F=()=>{if(d){console.warn("Socket already iniitialized");return}return v("SET_ID",t=>{d&&(d.id=t)}),d=new WebSocket(B),d.emit=(t,r)=>{d.send(JSON.stringify({action:t,payload:r}))},d.addEventListener("message",t=>{const{data:r}=t,{action:s,payload:e}=JSON.parse(r);T[s]&&T[s](e)}),console.log("Socket Initialized"),d},b={init:F,listen:v},V=({children:t})=>(p.exports.useEffect(()=>{b.init()},[]),c(I,{children:t})),z=t=>{const{options:r,onClick:s,className:e}=t,n=()=>e?" "+e:"",l=i=>{const{id:o}=i.target;s&&o&&s(o)};return c("div",{className:"menu flex-col"+n(),onClick:l,children:r.map(({id:i,text:o})=>f("button",{id:i,children:[" ",o," "]},i))})};const A=t=>{switch(parseInt(t)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}};const $=t=>{const{keys:r,onClick:s,disabled:e}=t,n=i=>{var E,N;if(e)return;i.preventDefault();const o=((N=(E=i.touches)==null?void 0:E[0])==null?void 0:N.target.id)||i.target.id;s&&s({key:o})},l=(i,o,E)=>{const N=h.KEYS["ROW_"+i];return f("div",{className:"flex keyboard-row",children:[o,N.map(u=>c(R,{letter:u,status:(r==null?void 0:r[u])>=0?r[u]:3,id:u},u)),E]})};return f("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:n,onClick:n,children:[l(0),l(1),l(2,c(R,{letter:"ENTER",status:3,id:"enter"}),c(R,{letter:c(I,{children:"\xAB"}),status:3,id:"backspace"}))]})},R=({letter:t,status:r,className:s,id:e})=>{let n=["flex keyboard-key",A(r),s||""].join(" ");return f("button",{className:n,id:e,children:[" ",t," "]})},H=t=>{const{keys:r,history:s,inProgress:e,keyboardDisabled:n,onKeyPress:l,current:i}=t,o=p.exports.useRef(null),E=p.exports.useRef(null);p.exports.useEffect(()=>{var a;(a=o==null?void 0:o.current)==null||a.focus()},[o]),p.exports.useEffect(()=>{E.current.scrollIntoView()},[i]);const N=a=>{if(!n)switch(a.key.toUpperCase()){case"ENTER":l&&l("ENTER");break;case"BACKSPACE":l&&l(null);break;default:/^[a-zA-Z]$/.test(a.key)&&l&&l(a.key);break}},u=()=>{const a=[];for(let m=0;m<5;m++)a.push(c(w,{letter:i[m],status:i[m]?4:5},(i[m]||"")+m));return a};return f("div",{className:"game-board flex-col flex-fill ",onKeyDown:N,tabIndex:"0",ref:o,children:[f("div",{className:"flex-col flex-fill overflow game-board-list",children:[s==null?void 0:s.map((a,m)=>c("div",{className:"flex "+(m===s.length-1?"game-board-last":""),children:a==null?void 0:a.map((g,L)=>p.exports.createElement(w,x(y({},g),{key:g+L})))},a+m)),c("div",{className:"flex game-board-current",ref:E,children:e&&u()},s==null?void 0:s.length)]}),c($,{keys:r,disabled:n,onClick:N})]})},w=({letter:t,status:r})=>{const s=["flex game-board-letter",A(r)].join(" ");return c("div",{className:"game-board-letter-wrapper",children:f("span",{className:s,children:[" ",t||h.BLANK," "]})})},X=t=>{const{host:r,room:s}=t,[e,n]=p.exports.useState(null),[l,i]=p.exports.useState([]);p.exports.useEffect(()=>{d.emit("JOIN",{room:s}),b.listen("JOIN",n),b.listen("UPDATE",u=>{n(u),i(a=>a.join("")!==(u==null?void 0:u.current.join(""))?u==null?void 0:u.current:a)})},[]);const o=()=>{r&&d.emit("START")},E=()=>{r&&d.emit("END")},N=u=>{u==="ENTER"?(i([]),d.emit("ENTER_WORD")):u?(i(a=>a.length<5?[...a,u]:a),d.emit("PRESS_LETTER",{letter:u})):(i(a=>{let m=[...a];return m.pop(),m}),d.emit("REMOVE_LETTER"))};return f("div",{className:"flex-col flex-fill game",children:[(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&f("div",{className:"flex-col flex-fill game-end",children:[c("label",{className:"game-end-label",children:" Word: "}),f("a",{className:"game-end-word",href:h.DICTIONARY_URL+(e==null?void 0:e.word.toLowerCase()),children:[" ",e==null?void 0:e.word," "]}),c("button",{className:r?"":"hidden",onClick:E,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&c(H,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:l,onKeyPress:N,inProgress:e==null?void 0:e.turn,keyboardDisabled:(e==null?void 0:e.turn)!==(d==null?void 0:d.id)}),!(e!=null&&e.inProgress)&&f("div",{className:"flex-col flex-fill game-lobby",children:[f("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),f("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),c("button",{className:"start-btn",onClick:o,children:r?"START":"WAITING FOR HOST"})]})]})},q=()=>{const[t,r]=p.exports.useReducer(Z,Q),s=p.exports.useRef(!1);p.exports.useEffect(()=>{b.listen("CREATE",o=>{r({type:"viewJoin",payload:{room:o,host:!0}}),s.current=!1}),b.listen("VERIFY",o=>{s.current=!1,o&&r({type:"viewJoin",payload:{room:o,host:!1}})})},[]),p.exports.useEffect(()=>{setInterval(()=>{d.emit("PING_TEST")},12e3)},[]);const e=o=>{if(!s.current)switch(o){case h.CREATE:s.current=!0,d.emit("CREATE");break;case h.JOIN:r({type:"viewCodeInput"});break;case h.PLAY:s.current=!0,d.emit("VERIFY",{room:t.room});break;default:console.log(o);return}},n=o=>{r({type:"setCodeInput",payload:o.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},l=()=>{var o;return f("div",{className:"flex-col",children:[c("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:t.room||"",onChange:n,spellCheck:"false",autoComplete:"false",autoFocus:!0}),c("button",{className:"flex play-btn "+(((o=t.room)==null?void 0:o.length)===5?"":"hidden"),onClick:()=>e(h.PLAY),children:c("img",{src:h.TRIANGLE_RIGHT})})]})};return c("div",{className:"app",children:c(V,{children:(()=>{switch(t.view){case"game":return c(X,{host:t.host,room:t.room});default:return f("div",{className:"main-screen flex-col flex-fill",children:[c("label",{className:"flex title-label",children:" XORDLE "}),t.view!=="codeInput"?c(z,{options:h.MENU_OPTIONS,onClick:e}):l()]})}})()})})},Z=(t,r)=>{const{type:s,payload:e}=r;switch(s){case"viewJoin":return x(y({},t),{view:"game",room:e.room,host:e.host});case"viewCodeInput":return x(y({},t),{view:"codeInput"});case"setCodeInput":return x(y({},t),{room:e});default:return y({},t)}},Q={view:h.VIEW,room:null};G.render(c(J.StrictMode,{children:c(q,{})}),document.getElementById("root"));
