var V=Object.defineProperty,z=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var J=(n,t,s)=>t in n?V(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s,x=(n,t)=>{for(var s in t||(t={}))$.call(t,s)&&J(n,s,t[s]);if(B)for(var s of B(t))X.call(t,s)&&J(n,s,t[s]);return n},R=(n,t)=>z(n,H(t));import{j,r as h,R as q,a as Z}from"./vendor.8cd058a3.js";const Q=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&e(f)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function e(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}};Q();const r=j.exports.jsx,d=j.exports.jsxs,O=j.exports.Fragment,M={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},D={MENU_OPTIONS:[{id:M.CREATE,text:"CREATE"},{id:M.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:r(O,{children:"\xA0"})},C=x(x({},M),D),ee="xordle.herokuapp.com",te="wss://"+ee;let i=null,L=null;const U={},K=(n,t)=>n.split(" ").forEach(s=>U[s]=e=>{t(e)}),W=()=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(L),L=null);const n=()=>{i.emit("PING")};return K("PING",()=>{console.log("Received server ping")}),K("SET_ID",t=>{if(!i)return;i.id=t;let s=localStorage.getItem("xordle_id");s&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:s}));let e=localStorage.getItem("xordle_name");e&&i.setName(e),localStorage.setItem("xordle_id",t),console.log("Socket initialized")}),i=new WebSocket(te),i.emit=(t,s)=>{i?i.send(JSON.stringify({action:t,payload:s})):console.warn("No client found")},i.setName=t=>{localStorage.setItem("xordle_name",t),i.emit("SET_NAME",{name:t})},i.addEventListener("message",t=>{const{data:s}=t,{action:e,payload:o}=JSON.parse(s);U[e]&&U[e](o)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),W()}),L=setInterval(n,C.PING_DELAY),i},S={init:W,listen:K},se=n=>{const{children:t}=n;return h.exports.useEffect(()=>{S.init()},[]),r(O,{children:t})},ne=n=>{const{options:t,onClick:s,className:e}=n,o=()=>e?" "+e:"",l=f=>{const{id:a}=f.target;s&&a&&s(a)};return r("div",{className:"menu flex-col"+o(),onClick:l,children:t.map(({id:f,text:a})=>d("button",{id:f,children:[" ",a," "]},f))})};const Y=n=>{switch(parseInt(n)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},le=n=>n<33?"bg-red":n<66?"bg-yellow":"bg-green",re=n=>/^[a-zA-Z]$/.test(n);const oe=n=>{const{keys:t,onClick:s,disabled:e}=n,o=a=>{var g,b;if(!e)if((g=a.touches)!=null&&g.length){let c=[];for(let u of a.touches)u&&c.push(u);c=c[c.length-1],((b=c==null?void 0:c.target)==null?void 0:b.id)&&s&&s({key:c.target.id})}else a.target.id&&s&&s({key:a.target.id})},l=(a,g,b)=>{const c=C.KEYS["ROW_"+a];return d("div",{className:"flex keyboard-row",children:[g,c.map(u=>r(_,{letter:u,status:(t==null?void 0:t[u])>=0?t[u]:3,id:u},u)),b]})},f=a=>a.preventDefault();return d("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:f,onTouchStart:o,onMouseUp:o,children:[l(0),l(1),l(2,r(_,{letter:"ENTER",status:3,id:"enter"}),r(_,{letter:r(O,{children:"\xAB"}),status:3,id:"backspace"}))]})},_=({letter:n,status:t,className:s,id:e})=>{let o=["flex keyboard-key",Y(t),s||""].join(" ");return r("span",{className:"flex keyboard-key-container",id:e,children:d("button",{className:o,id:e,children:[" ",n," "]})})},ce=n=>{const{keys:t,history:s,inProgress:e,timeRemaining:o,showTimeRemaining:l,keyboardDisabled:f,onKeyPress:a,current:g,room:b,name:c,message:u}=n,T=h.exports.useRef(null),k=h.exports.useRef(null);h.exports.useEffect(()=>{var m;(m=T==null?void 0:T.current)==null||m.focus()},[T]),h.exports.useEffect(()=>{k.current.scrollIntoView()},[g]);const A=m=>{if(!f)switch(m.key.toUpperCase()){case"ENTER":a&&a("ENTER");break;case"BACKSPACE":a&&a(null);break;default:re(m.key)&&a&&a(m.key.toUpperCase());break}},w=()=>s==null?void 0:s.map((m,N)=>s.length-1===N?r("div",{className:"flex game-board-last",children:m==null?void 0:m.map((y,v)=>h.exports.createElement(G,R(x({},y),{key:y+v,delay:v*60})))},m+N):r("div",{className:"flex",children:m==null?void 0:m.map((y,v)=>h.exports.createElement(G,R(x({},y),{key:y+v})))},m+N)),P=()=>{const m=[];for(let N=0;N<5;N++)m.push(r(G,{letter:g[N],status:g[N]?4:5},(g[N]||"")+N));return m};return d("div",{className:"game-board flex-col flex-fill ",onKeyDown:A,tabIndex:"0",ref:T,children:[d("label",{className:"floating-purple-text float-left",children:[" ",u," "]}),d("label",{className:"floating-purple-text float-right",children:[" ",b," "]}),d("div",{className:"flex-col flex-fill overflow game-board-list",children:[w(),r("div",{className:"flex game-board-current",ref:k,children:e&&P()},s==null?void 0:s.length)]}),l&&r(ie,{className:"game-board-progress",progress:o}),r(oe,{keys:t,disabled:f,onClick:A})]})},ie=({className:n,progress:t})=>{const s=t*100,e=[n||"","flex progress"].join(" "),o=["flex progress-bar",le(s)].join(" "),l={width:s+"%"};return r("div",{className:e,children:r("div",{className:o,style:l})})},G=({letter:n,status:t,delay:s})=>{const[e,o]=h.exports.useState("bg-placeholder active"),l=h.exports.useRef(null);h.exports.useEffect(()=>{if(s)return l.current=setTimeout(()=>{o(Y(t))},s),()=>clearTimeout(l.current)},[t,s]);const f=["flex game-board-letter",s?e:Y(t)].join(" ");return r("div",{className:"game-board-letter-wrapper",children:d("span",{className:f,children:[" ",n||C.BLANK," "]})})},ae=n=>{const{room:t,children:s}=n,[e,o]=h.exports.useState(null),[l,f]=h.exports.useState(null),[a,g]=h.exports.useState([]),[b,c]=h.exports.useState(!1),[u,T]=h.exports.useState(null),k=()=>(e==null?void 0:e.host)===i.id,A=p=>{o(p.room),f(p.player)};h.exports.useEffect(()=>{i.room=t,i.emit("JOIN",{room:t}),S.listen("JOIN",o),S.listen("UPDATE",o),S.listen("PLAYER_UPDATE",f),S.listen("SERVER_UPDATE",A),S.listen("SETTINGS_UPDATE",T)},[]),h.exports.useEffect(()=>{((l==null?void 0:l.correct)===!1||(l==null?void 0:l.correct)===!0)&&g([])},[l]);const w=()=>{c(p=>!p)},P=p=>{const E=R(x({},u),{[p.target.id]:p.target.checked});i.emit("SETTINGS_UPDATE",{settings:E})},m=()=>d("div",{className:"flex flex-col flex-fill settings-panel",children:[r("button",{className:"back-btn",onClick:w,children:" BACK "}),u&&Object.keys(u).map(p=>d("div",{className:"flex flex-middle",children:[r("input",{type:"checkbox",className:"flex",checked:u[p],id:p,onChange:P}),d("label",{className:"flex flex-middle",htmlFor:p,children:[" ",p," "]})]},p))]}),N=()=>{k()&&i.emit("START")},y=()=>{k()&&i.emit("END")},v=p=>{p==="ENTER"?(a.length===5&&i.emit("ENTER_WORD",{current:a}),g([])):g(p?E=>E.length<5?[...E,p]:E:E=>{if(E.length===0)return[];const I=[...E];return I.pop(),I})};return d("div",{className:"flex-col flex-fill game",children:[!(e!=null&&e.status)>0&&!b&&s,(e==null?void 0:e.status)===2&&d("div",{className:"flex-col flex-fill game-end",children:[d("label",{className:"game-end-word underline",children:[" ",e==null?void 0:e.word," "]}),e==null?void 0:e.winOrder.map(({name:p,attempts:E},I)=>{const F=E>0?"TRIES":"TRY";return I<4?d("label",{className:"game-end-word",children:[" #",I+1," - ",p," (",E," ",F,")"]},I+p):null}),r("button",{className:k()?"":"hidden",onClick:y,children:" RESTART "})]}),(e==null?void 0:e.status)>0&&r(ce,{keys:l==null?void 0:l.keys,history:l==null?void 0:l.history,current:a,onKeyPress:v,inProgress:l==null?void 0:l.inProgress,timeRemaining:l==null?void 0:l.timeRemaining,showTimeRemaining:u==null?void 0:u["GUESS TIMER"],keyboardDisabled:!(l!=null&&l.inProgress),name:(l==null?void 0:l.name)||i.name,room:t,message:(u!=null&&u["GAME TIMER"]?"["+(e==null?void 0:e.timeRemaining)+"] ":"")+(e==null?void 0:e.message)}),(e==null?void 0:e.status)===0&&d("div",{className:"flex-col flex-fill game-lobby",children:[r("button",{className:"flex floating-purple-text float-right",onClick:w,children:" SETTINGS "}),d("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),b?m():d(O,{children:[d("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),r("button",{className:"start-btn",onClick:N,children:k()?"START":"WAITING FOR HOST"})]})]})]})},ue=()=>{const[n,t]=h.exports.useReducer(de,fe),s=h.exports.useRef(!1);h.exports.useEffect(()=>{S.listen("CREATE",c=>{t({type:"viewJoin",payload:{room:c}}),s.current=!1}),S.listen("VERIFY",c=>{s.current=!1,t(c?{type:"viewJoin",payload:{room:c}}:{type:"viewMain"})}),S.listen("RECONNECT",c=>{c||t({type:"viewMain"})})},[]);const e=c=>{if(!s.current)switch(c){case C.CREATE:s.current=!0,i.emit("CREATE");break;case C.JOIN:t({type:"viewCodeInput"});break;case C.PLAY:s.current=!0,i.emit("VERIFY",{room:n.room});break;default:console.log(c);return}},o=()=>{i.emit("LEAVE"),t({type:"viewMain"})},l=c=>{t({type:"setCodeInput",payload:c.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},f=()=>{var c;return d("div",{className:"flex-col",children:[r("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:n.room||"",onChange:l,spellCheck:"false",autoComplete:"false",autoFocus:!0}),r("button",{className:"flex play-btn "+(((c=n.room)==null?void 0:c.length)===5?"":"hidden"),onClick:()=>e(C.PLAY),children:r("img",{src:C.TRIANGLE_RIGHT})})]})},a=c=>{const u=c.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase();t({type:"setNameInput",payload:u}),i.name=u,i.setName(u)},g=()=>r("div",{className:"flex-col",children:r("input",{className:"input",type:"text",placeholder:"PLAYER NAME",value:n.name||"",onChange:a,spellCheck:"false",autoComplete:"false",autoFocus:!0})});return r("div",{className:"app",children:r(se,{children:(()=>{const c=n.view&&r("button",{className:"back-btn",onClick:o,children:" BACK "});switch(n.view){case"game":return r(ae,{room:n.room,children:c});case"codeInput":return d("div",{className:"main-screen flex-col flex-fill",children:[c,r("label",{className:"flex title-label",children:" XORDLE "}),f()]});default:return d("div",{className:"main-screen flex-col flex-fill",children:[c,r("label",{className:"flex title-label",children:" XORDLE "}),g(),r(ne,{options:C.MENU_OPTIONS,onClick:e})]})}})()})})},de=(n,t)=>{const{type:s,payload:e}=t;switch(s){case"viewMain":return R(x({},n),{view:null,room:null});case"viewJoin":return R(x({},n),{view:"game",room:e.room});case"viewCodeInput":return R(x({},n),{view:"codeInput"});case"setCodeInput":return R(x({},n),{room:e});case"setNameInput":return R(x({},n),{name:e});default:return x({},n)}},fe={view:C.VIEW,room:null,name:localStorage.getItem("xordle_name")};q.render(r(Z.StrictMode,{children:r(ue,{})}),document.getElementById("root"));
