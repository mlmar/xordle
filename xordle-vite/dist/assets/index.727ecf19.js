var K=Object.defineProperty,j=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var P=(r,t,e)=>t in r?K(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,y=(r,t)=>{for(var e in t||(t={}))G.call(t,e)&&P(r,e,t[e]);if(L)for(var e of L(t))J.call(t,e)&&P(r,e,t[e]);return r},b=(r,t)=>j(r,U(t));import{j as O,r as f,R as W,a as Y}from"./vendor.2d6b8063.js";const M=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}};M();const l=O.exports.jsx,p=O.exports.jsxs,A=O.exports.Fragment,S={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},B={MENU_OPTIONS:[{id:S.CREATE,text:"CREATE"},{id:S.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:3e4,BLANK:l(A,{children:"\xA0"})},E=y(y({},S),B),w="xordle.onrender.com",V="https://"+w,F="wss://"+w;let d=null;const I={},_=(r,t)=>I[r]=t,H=()=>{if(d){console.warn("Socket already iniitialized");return}return _("SET_ID",r=>{d&&(d.id=r)}),d=new WebSocket(F),d.emit=(r,t)=>{d.send(JSON.stringify({action:r,payload:t}))},d.addEventListener("message",r=>{const{data:t}=r,{action:e,payload:c}=JSON.parse(t);I[e]&&I[e](c)}),console.log("Socket Initialized"),d},C={init:H,listen:_},z=({children:r})=>(f.exports.useEffect(()=>{const t=()=>{fetch(V+"/ping").then(e=>e.json()).then(()=>console.log("Pinged Server"))};C.init(),t(),setInterval(t,E.PING_DELAY)},[]),l(A,{children:r})),$=r=>{const{options:t,onClick:e,className:c}=r,n=()=>c?" "+c:"",s=i=>{const{id:o}=i.target;e&&o&&e(o)};return l("div",{className:"menu flex-col"+n(),onClick:s,children:t.map(({id:i,text:o})=>p("button",{id:i,children:[" ",o," "]},i))})};const v=r=>{switch(parseInt(r)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}};const X=r=>{const{keys:t,onClick:e,disabled:c}=r,n=i=>{var N,x;if(c)return;i.preventDefault();const o=((x=(N=i.touches)==null?void 0:N[0])==null?void 0:x.target.id)||i.target.id;e&&e({key:o})},s=(i,o,N)=>{const x=E.KEYS["ROW_"+i];return p("div",{className:"flex keyboard-row",children:[o,x.map(u=>l(k,{letter:u,status:(t==null?void 0:t[u])>=0?t[u]:3,id:u},u)),N]})};return p("div",{className:"keyboard flex-col "+(c?"disabled":""),onTouchEnd:n,onClick:n,children:[s(0),s(1),s(2,l(k,{letter:"ENTER",status:3,id:"enter"}),l(k,{letter:l(A,{children:"\xAB"}),status:3,id:"backspace"}))]})},k=({letter:r,status:t,className:e,id:c})=>{let n=["flex keyboard-key",v(t),e||""].join(" ");return p("button",{className:n,id:c,children:[" ",r," "]})},q=r=>{const{keys:t,history:e,inProgress:c,keyboardDisabled:n,onKeyPress:s,current:i}=r,o=f.exports.useRef(null),N=f.exports.useRef(null);f.exports.useEffect(()=>{var a;(a=o==null?void 0:o.current)==null||a.focus()},[o]),f.exports.useEffect(()=>{N.current.scrollIntoView()},[i]);const x=a=>{if(!n)switch(a.key.toUpperCase()){case"ENTER":s&&s("ENTER");break;case"BACKSPACE":s&&s(null);break;default:/^[a-zA-Z]$/.test(a.key)&&s&&s(a.key);break}},u=()=>e==null?void 0:e.map((a,h)=>e.length-1===h?l("div",{className:"flex game-board-last",children:a==null?void 0:a.map((R,g)=>f.exports.createElement(T,b(y({},R),{key:R+g,delay:g*60})))},a+h):l("div",{className:"flex",children:a==null?void 0:a.map((R,g)=>f.exports.createElement(T,b(y({},R),{key:R+g})))},a+h)),m=()=>{const a=[];for(let h=0;h<5;h++)a.push(l(T,{letter:i[h],status:i[h]?4:5},(i[h]||"")+h));return a};return p("div",{className:"game-board flex-col flex-fill ",onKeyDown:x,tabIndex:"0",ref:o,children:[p("div",{className:"flex-col flex-fill overflow game-board-list",children:[u(),l("div",{className:"flex game-board-current",ref:N,children:c&&m()},e==null?void 0:e.length)]}),l(X,{keys:t,disabled:n,onClick:x})]})},T=({letter:r,status:t,delay:e})=>{const[c,n]=f.exports.useState("");f.exports.useEffect(()=>{e&&setTimeout(()=>{n(v(t))},e)},[t,e]);const s=["flex game-board-letter",e?c:v(t)].join(" ");return l("div",{className:"game-board-letter-wrapper",children:p("span",{className:s,children:[" ",r||E.BLANK," "]})})},Z=r=>{const{room:t}=r,[e,c]=f.exports.useState(null),[n,s]=f.exports.useState([]),i=()=>(e==null?void 0:e.host)===d.id;f.exports.useEffect(()=>{d.emit("JOIN",{room:t}),C.listen("JOIN",c),C.listen("UPDATE",u=>{c(u),s(m=>m.join("")!==(u==null?void 0:u.current.join(""))?u==null?void 0:u.current:m)})},[]);const o=()=>{i()&&d.emit("START")},N=()=>{i()&&d.emit("END")},x=u=>{u==="ENTER"?(s([]),d.emit("ENTER_WORD")):u?(s(m=>m.length<5?[...m,u.toUpperCase()]:m),d.emit("PRESS_LETTER",{letter:u})):(s(m=>{let a=[...m];return a.pop(),a}),d.emit("REMOVE_LETTER"))};return p("div",{className:"flex-col flex-fill game",children:[(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&p("div",{className:"flex-col flex-fill game-end",children:[l("label",{className:"game-end-label",children:" Word: "}),p("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),l("button",{className:i()?"":"hidden",onClick:N,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&l(q,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:n,onKeyPress:x,inProgress:e==null?void 0:e.turn,keyboardDisabled:(e==null?void 0:e.turn)!==(d==null?void 0:d.id)}),!(e!=null&&e.inProgress)&&p("div",{className:"flex-col flex-fill game-lobby",children:[p("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),p("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),l("button",{className:"start-btn",onClick:o,children:i()?"START":"WAITING FOR HOST"})]})]})},Q=()=>{const[r,t]=f.exports.useReducer(D,ee),e=f.exports.useRef(!1);f.exports.useEffect(()=>{C.listen("CREATE",o=>{t({type:"viewJoin",payload:{room:o}}),e.current=!1}),C.listen("VERIFY",o=>{e.current=!1,o&&t({type:"viewJoin",payload:{room:o}})})},[]);const c=o=>{if(!e.current)switch(o){case E.CREATE:e.current=!0,d.emit("CREATE");break;case E.JOIN:t({type:"viewCodeInput"});break;case E.PLAY:e.current=!0,d.emit("VERIFY",{room:r.room});break;default:console.log(o);return}},n=o=>{t({type:"setCodeInput",payload:o.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},s=()=>{var o;return p("div",{className:"flex-col",children:[l("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:r.room||"",onChange:n,spellCheck:"false",autoComplete:"false",autoFocus:!0}),l("button",{className:"flex play-btn "+(((o=r.room)==null?void 0:o.length)===5?"":"hidden"),onClick:()=>c(E.PLAY),children:l("img",{src:E.TRIANGLE_RIGHT})})]})};return l("div",{className:"app",children:l(z,{children:(()=>{switch(r.view){case"game":return l(Z,{room:r.room});default:return p("div",{className:"main-screen flex-col flex-fill",children:[l("label",{className:"flex title-label",children:" XORDLE "}),r.view!=="codeInput"?l($,{options:E.MENU_OPTIONS,onClick:c}):s()]})}})()})})},D=(r,t)=>{const{type:e,payload:c}=t;switch(e){case"viewJoin":return b(y({},r),{view:"game",room:c.room});case"viewCodeInput":return b(y({},r),{view:"codeInput"});case"setCodeInput":return b(y({},r),{room:c});default:return y({},r)}},ee={view:E.VIEW,room:null};W.render(l(Y.StrictMode,{children:l(Q,{})}),document.getElementById("root"));
