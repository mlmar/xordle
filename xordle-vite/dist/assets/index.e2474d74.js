var B=Object.defineProperty,M=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var U=(t,s,n)=>s in t?B(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,E=(t,s)=>{for(var n in s||(s={}))W.call(s,n)&&U(t,n,s[n]);if(G)for(var n of G(s))Y.call(s,n)&&U(t,n,s[n]);return t},y=(t,s)=>M(t,J(s));import{j as K,r as m,R as V,a as F}from"./vendor.2d6b8063.js";const H=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))e(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerpolicy&&(c.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?c.credentials="include":r.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function e(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}};H();const l=K.exports.jsx,p=K.exports.jsxs,_=K.exports.Fragment,A={MENU:"menu",CREATE:"create",JOIN:"join",EXIT:"exit",PLAY:"play"},z={MENU_OPTIONS:[{id:A.CREATE,text:"CREATE"},{id:A.JOIN,text:"JOIN"}],KEYS:{ROW_0:"qwertyuiop".toUpperCase().split(""),ROW_1:"asdfghjkl".toUpperCase().split(""),ROW_2:"zxcvbnm".toUpperCase().split("")},TRIANGLE_RIGHT:"/TriangleRight.png",PING_DELAY:25e3,BLANK:l(_,{children:"\xA0"})},b=E(E({},A),z),$="localhost:3300",X="ws://"+$;let i=null,T=null,I=null;const w={},L=(t,s)=>t.split(" ").forEach(n=>w[n]=s),j=()=>{i&&(console.warn("Client already initialized. Removing existing client..."),i.close(),clearInterval(I),I=null);const t=()=>{i.emit("PING")};return L("PING",()=>{console.log("Received server ping")}),L("SET_ID",s=>{!i||(i.id=s,T&&(console.log("Reconnecting..."),i.emit("RECONNECT",{previousID:T})),T=s,console.log("Socket initialized"))}),i=new WebSocket(X),i.emit=(s,n)=>{i?i.send(JSON.stringify({action:s,payload:n})):console.warn("No client found")},i.addEventListener("message",s=>{const{data:n}=s,{action:e,payload:r}=JSON.parse(n);w[e]&&w[e](r)}),i.addEventListener("close",()=>{console.warn("Client closed. Reconnecting..."),j()}),I=setInterval(t,b.PING_DELAY),i},R={init:j,listen:L},q=t=>{const{children:s}=t;return m.exports.useEffect(()=>{R.init()},[]),l(_,{children:s})},Z=t=>{const{options:s,onClick:n,className:e}=t,r=()=>e?" "+e:"",c=o=>{const{id:u}=o.target;n&&u&&n(u)};return l("div",{className:"menu flex-col"+r(),onClick:c,children:s.map(({id:o,text:u})=>p("button",{id:o,children:[" ",u," "]},o))})};const P=t=>{switch(parseInt(t)){case 1:return"bg-green";case 2:return"bg-yellow";case 3:return"bg-neutral";case 4:return"bg-placeholder active";case 5:return"bg-placeholder";default:return"bg-gray"}},Q=t=>t<33?"bg-red":t<66?"bg-yellow":"bg-green",D=t=>/^[a-zA-Z]$/.test(t);const ee=t=>{const{keys:s,onClick:n,disabled:e}=t,r=o=>{var u;e||(o.preventDefault(),o.target.id?n&&n({key:o.target.id}):(u=o.touches)==null||u.forEach(a=>{n&&n({key:a.id})}))},c=(o,u,a)=>{const g=b.KEYS["ROW_"+o];return p("div",{className:"flex keyboard-row",children:[u,g.map(h=>l(S,{letter:h,status:(s==null?void 0:s[h])>=0?s[h]:3,id:h},h)),a]})};return p("div",{className:"keyboard flex-col "+(e?"disabled":""),onTouchEnd:r,onClick:r,children:[c(0),c(1),c(2,l(S,{letter:"ENTER",status:3,id:"enter"}),l(S,{letter:l(_,{children:"\xAB"}),status:3,id:"backspace"}))]})},S=({letter:t,status:s,className:n,id:e})=>{let r=["flex keyboard-key",P(s),n||""].join(" ");return p("button",{className:r,id:e,children:[" ",t," "]})},se=t=>{const{keys:s,history:n,inProgress:e,timeRemaining:r,keyboardDisabled:c,onKeyPress:o,current:u,room:a}=t,g=m.exports.useRef(null),h=m.exports.useRef(null);m.exports.useEffect(()=>{var f;(f=g==null?void 0:g.current)==null||f.focus()},[g]),m.exports.useEffect(()=>{h.current.scrollIntoView()},[u]);const d=f=>{if(!c)switch(f.key.toUpperCase()){case"ENTER":o&&o("ENTER");break;case"BACKSPACE":o&&o(null);break;default:D(f.key)&&o&&o(f.key.toUpperCase());break}},x=()=>n==null?void 0:n.map((f,N)=>n.length-1===N?l("div",{className:"flex game-board-last",children:f==null?void 0:f.map((k,v)=>m.exports.createElement(O,y(E({},k),{key:k+v,delay:v*60})))},f+N):l("div",{className:"flex",children:f==null?void 0:f.map((k,v)=>m.exports.createElement(O,y(E({},k),{key:k+v})))},f+N)),C=()=>{const f=[];for(let N=0;N<5;N++)f.push(l(O,{letter:u[N],status:u[N]?4:5},(u[N]||"")+N));return f};return p("div",{className:"game-board flex-col flex-fill ",onKeyDown:d,tabIndex:"0",ref:g,children:[p("label",{className:"floating-purple-text float-right",children:[" ",a," "]}),p("div",{className:"flex-col flex-fill overflow game-board-list",children:[x(),l("div",{className:"flex game-board-current",ref:h,children:e&&C()},n==null?void 0:n.length)]}),l(ne,{className:"game-board-progress",progress:r}),l(ee,{keys:s,disabled:c,onClick:d})]})},ne=({className:t,progress:s})=>{const n=s*100,e=[t||"","flex progress"].join(" "),r=["flex progress-bar",Q(n)].join(" "),c={width:n+"%"};return l("div",{className:e,children:l("div",{className:r,style:c})})},O=({letter:t,status:s,delay:n})=>{const[e,r]=m.exports.useState("bg-placeholder");m.exports.useEffect(()=>{n&&setTimeout(()=>{r(P(s))},n)},[s,n]);const c=["flex game-board-letter",n?e:P(s)].join(" ");return l("div",{className:"game-board-letter-wrapper",children:p("span",{className:c,children:[" ",t||b.BLANK," "]})})},te=t=>{const{room:s,children:n}=t,[e,r]=m.exports.useState(null),[c,o]=m.exports.useState([]),u=()=>(e==null?void 0:e.host)===i.id;m.exports.useEffect(()=>{i.room=s,i.emit("JOIN",{room:s}),R.listen("JOIN",r),R.listen("UPDATE",d=>{r(()=>((d==null?void 0:d.status)===1?o([]):(d==null?void 0:d.status)===0&&(d==null?void 0:d.turn)!==i.id&&o(d==null?void 0:d.current),d))})},[]);const a=()=>{u()&&i.emit("START")},g=()=>{u()&&i.emit("END")},h=d=>{d==="ENTER"?c.length===5?i.emit("ENTER_WORD"):o([]):o(d?x=>{const C=x.length<5?[...x,d]:x;return i.emit("SET_CURRENT",{current:C}),C}:x=>{if(x.length===0)return[];const C=[...x];return C.pop(),i.emit("SET_CURRENT",{current:C}),C})};return p("div",{className:"flex-col flex-fill game",children:[!(e!=null&&e.inProgress)&&n,(e==null?void 0:e.inProgress)&&!(e!=null&&e.turn)&&p("div",{className:"flex-col flex-fill game-end",children:[l("label",{className:"game-end-label",children:" Word: "}),p("label",{className:"game-end-word",children:[" ",e==null?void 0:e.word," "]}),l("button",{className:u()?"":"hidden",onClick:g,children:" RESTART "})]}),(e==null?void 0:e.inProgress)&&l(se,{keys:e==null?void 0:e.keys,history:e==null?void 0:e.history,current:c,onKeyPress:h,inProgress:e==null?void 0:e.turn,timeRemaining:e==null?void 0:e.timeRemaining,keyboardDisabled:(e==null?void 0:e.turn)!==(i==null?void 0:i.id),room:s}),!(e!=null&&e.inProgress)&&p("div",{className:"flex-col flex-fill game-lobby",children:[p("label",{className:"flex room-code",children:[" ",e==null?void 0:e.id," "]}),p("p",{className:"flex-col flex-fill",children:[" ",e==null?void 0:e.playerCount," PLAYER",(e==null?void 0:e.playerCount)>1?"S":""," "]}),l("button",{className:"start-btn",onClick:a,children:u()?"START":"WAITING FOR HOST"})]})]})},re=()=>{const[t,s]=m.exports.useReducer(le,oe),n=m.exports.useRef(!1);m.exports.useEffect(()=>{R.listen("CREATE",a=>{s({type:"viewJoin",payload:{room:a}}),n.current=!1}),R.listen("VERIFY",a=>{n.current=!1,a&&s({type:"viewJoin",payload:{room:a}})}),R.listen("RECONNECT",a=>{a||s({type:"viewMain "})})},[]);const e=a=>{if(!n.current)switch(a){case b.CREATE:n.current=!0,i.emit("CREATE");break;case b.JOIN:s({type:"viewCodeInput"});break;case b.PLAY:n.current=!0,i.emit("VERIFY",{room:t.room});break;default:console.log(a);return}},r=()=>{i.emit("LEAVE"),s({type:"viewMain"})},c=a=>{s({type:"setCodeInput",payload:a.target.value.replace(/[^a-z]/gi,"").substring(0,5).toUpperCase()})},o=()=>{var a;return p("div",{className:"flex-col",children:[l("input",{className:"input",type:"text",placeholder:"ROOM CODE",value:t.room||"",onChange:c,spellCheck:"false",autoComplete:"false",autoFocus:!0}),l("button",{className:"flex play-btn "+(((a=t.room)==null?void 0:a.length)===5?"":"hidden"),onClick:()=>e(b.PLAY),children:l("img",{src:b.TRIANGLE_RIGHT})})]})};return l("div",{className:"app",children:l(q,{children:(()=>{const a=t.view&&l("button",{className:"back-btn",onClick:r,children:" BACK "});switch(t.view){case"game":return l(te,{room:t.room,children:a});case"codeInput":return p("div",{className:"main-screen flex-col flex-fill",children:[a,l("label",{className:"flex title-label",children:" XORDLE "}),o()]});default:return p("div",{className:"main-screen flex-col flex-fill",children:[a,l("label",{className:"flex title-label",children:" XORDLE "}),l(Z,{options:b.MENU_OPTIONS,onClick:e})]})}})()})})},le=(t,s)=>{const{type:n,payload:e}=s;switch(n){case"viewMain":return y(E({},t),{view:null,room:null});case"viewJoin":return y(E({},t),{view:"game",room:e.room});case"viewCodeInput":return y(E({},t),{view:"codeInput"});case"setCodeInput":return y(E({},t),{room:e});default:return E({},t)}},oe={view:b.VIEW,room:null};V.render(l(F.StrictMode,{children:l(re,{})}),document.getElementById("root"));
